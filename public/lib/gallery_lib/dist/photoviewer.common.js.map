{"version":3,"file":"photoviewer.common.js","sources":["../src/js/defaults.js","../src/js/utilities.js","../src/js/constants.js","../src/js/draggable.js","../src/js/movable.js","../src/js/resizable.js","../src/js/core.js"],"sourcesContent":["export default {\n\n  // Enable modal to drag\n  draggable: true,\n\n  // Enable modal to resize\n  resizable: true,\n\n  // Enable image to move\n  movable: true,\n\n  // Enable keyboard navigation\n  keyboard: true,\n\n  // Shows the title\n  title: true,\n\n  // Min width of modal\n  modalWidth: 320,\n\n  // Min height of modal\n  modalHeight: 320,\n\n  // Enable the page content fixed\n  fixedContent: true,\n\n  // Disable the modal size fixed\n  fixedModalSize: false,\n\n  // Disable the image viewer maximized on init\n  initMaximized: false,\n\n  // Threshold of modal to browser window\n  gapThreshold: 0.02,\n\n  // Threshold of image ratio\n  ratioThreshold: 0.1,\n\n  // Min ratio of image when zoom out\n  minRatio: 0.1,\n\n  // Max ratio of image when zoom in\n  maxRatio: 16,\n\n  // Toolbar options in header\n  headToolbar: [\n    'maximize',\n    'close'\n  ],\n\n  // Toolbar options in footer\n  footToolbar: [\n    'zoomIn',\n    'zoomOut',\n    'prev',\n    'fullscreen',\n    'next',\n    'actualSize',\n    'rotateRight'\n  ],\n\n  // Customize button icon\n  icons: {\n    minimize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M20,14H4V10H20\"></path></svg>`,\n    maximize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M4,4H20V20H4V4M6,8V18H18V8H6Z\"></path></svg>`,\n    close: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5\n    V17.54L10.54,12L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z\"></path></svg>`,\n    zoomIn: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\n    C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,\n    13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9\n    V7H10V9H12V10Z\"></path></svg>`,\n    zoomOut: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,\n    9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5\n    L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z\"></path></svg>`,\n    prev: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z\"></path></svg>`,\n    next: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M16,18H18V6H16M6,18L14.5,12L6,6V18Z\"></path></svg>`,\n    fullscreen: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,\n    0 21,4H3A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z\"></path></svg>`,\n    actualSize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59\n    L9.5,13.09M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19H17.59L13.09,14.5L14.5,\n    13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91L13.09,9.5Z\"></path></svg>`,\n    rotateLeft: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,\n    12C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32C8.26,19.22 9.61,19.76 11,\n    19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,\n    13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z\"></path></svg>`,\n    rotateRight: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\"><path fill=\"currentColor\" d=\"M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,\n    13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,\n    17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,\n    4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z\"></path></svg>`\n  },\n\n  // Customize language of button title\n  i18n: {\n    minimize: 'minimize',\n    maximize: 'maximize',\n    close: 'close',\n    zoomIn: 'zoom-in(+)',\n    zoomOut: 'zoom-out(-)',\n    prev: 'prev(←)',\n    next: 'next(→)',\n    fullscreen: 'fullscreen',\n    actualSize: 'actual-size(Ctrl+Alt+0)',\n    rotateLeft: 'rotate-left(Ctrl+,)',\n    rotateRight: 'rotate-right(Ctrl+.)'\n  },\n\n  // Enable multiple instances\n  multiInstances: true,\n\n  // Enable animation\n  initAnimation: true,\n\n  // Disable modal position fixed when change images\n  fixedModalPos: false,\n\n  // Modal z-index\n  zIndex: 1090,\n\n  // Selector of drag handler\n  dragHandle: false,\n\n  // Callback events\n  callbacks: {\n    beforeOpen: $.noop,\n    opened: $.noop,\n    beforeClose: $.noop,\n    closed: $.noop,\n    beforeChange: $.noop,\n    changed: $.noop\n  },\n\n  // Start images index\n  index: 0\n\n}\n","/**\n * [getImgSrc]\n * @param {[Object]}  el    [description]\n */\nexport function getImgSrc(el) {\n  // Get data-src as image src at first\n  let src = $(el).attr('data-src') ? $(el).attr('data-src') : $(el).attr('href');\n  return src;\n}\n\n/**\n * [throttle]\n * @param  {Function} fn    [description]\n * @param  {[Number]} delay [description]\n * @return {Function}       [description]\n */\nexport function throttle(fn, delay) {\n\n  let timer = null;\n\n  return function () {\n    let context = this,\n      args = arguments;\n\n    clearTimeout(timer);\n\n    timer = setTimeout(function () {\n      fn.apply(context, args);\n    }, delay);\n  };\n\n}\n\n/**\n * [preloadImg]\n * @param  {[String]}  src      [image src]\n * @param  {Function}  success  [callbacks]\n * @param  {Function}  error    [callbacks]\n */\nexport function preloadImg(src, success, error) {\n\n  let img = new Image();\n\n  img.onload = function () {\n    success(img);\n  };\n\n  img.onerror = function () {\n    error(img);\n  };\n\n  img.src = src;\n\n}\n\n/**\n * [requestFullscreen]\n * @param  {[type]} element [description]\n */\nexport function requestFullscreen(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  }\n}\n\n/**\n * [exitFullscreen]\n */\nexport function exitFullscreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n\n/**\n * [getImageNameFromUrl]\n * @param  {[String]} url [description]\n * @return {[String]}     [description]\n */\nexport function getImageNameFromUrl(url) {\n  let reg = /^.*?\\/*([^/?]*)\\.[a-z]+(\\?.+|$)/ig,\n    txt = url.replace(reg, '$1');\n  return txt;\n}\n\n/**\n * [getNumFromCSSValue]\n * @param  {[String]} value [description]\n * @return {[Number]}       [description]\n */\nexport function getNumFromCSSValue(value) {\n  let reg = /\\d+/g,\n    arr = value.match(reg),\n    num = parseFloat(arr[0]);\n  return num;\n}\n\n/**\n * [hasScrollbar]\n * @return {[Boolean]}       [description]\n */\nexport function hasScrollbar() {\n  return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);\n}\n\n/**\n * [getScrollbarWidth]\n * @return {[Number]}       [description]\n */\nexport function getScrollbarWidth() {\n\n  let scrollDiv = document.createElement('div');\n  scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';\n  document.body.appendChild(scrollDiv);\n  let scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n  document.body.removeChild(scrollDiv);\n\n  return scrollbarWidth;\n\n}\n\n/**\n * [setGrabCursor]\n * @param {[Object]}  imageData    [description]\n * @param {[Object]}  stageData    [description]\n * @param {[Object]}  stage        [description]\n * @param {[Boolean]} isRotate     [description]\n */\nexport function setGrabCursor(imageData, stageData, stage, isRotated) {\n\n  let imageWidth = !isRotated ? imageData.w : imageData.h,\n    imageHeight = !isRotated ? imageData.h : imageData.w;\n\n  if (imageHeight > stageData.h || imageWidth > stageData.w) {\n    stage.addClass('is-grab');\n  }\n  if (imageHeight <= stageData.h && imageWidth <= stageData.w) {\n    stage.removeClass('is-grab');\n  }\n}\n\n/**\n * [supportTouch]\n * @return {[Boolean]}     [description]\n */\nexport function supportTouch() {\n  return !!(('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch);\n}\n","import defaults from './defaults';\nimport { supportTouch } from './utilities';\n\nexport const $W = $(window);\nexport const $D = $(document);\n\nexport const CLICK_EVENT = 'click';\nexport const RESIZE_EVENT = 'resize';\nexport const KEYDOWN_EVENT = 'keydown';\nexport const WHEEL_EVENT = 'wheel mousewheel DOMMouseScroll';\n\nexport const TOUCH_START_EVENT = supportTouch() ? 'touchstart' : 'mousedown';\nexport const TOUCH_MOVE_EVENT = supportTouch() ? 'touchmove' : 'mousemove';\nexport const TOUCH_END_EVENT = supportTouch() ? 'touchend' : 'mouseup';\n\nexport const NS = 'photoviewer';\nexport const CLASS_NS = '.' + NS;\nexport const EVENT_NS = '.' + NS;\n\nexport const PUBLIC_VARS = {\n  // image moving flag\n  isMoving: false,\n  // modal resizing flag\n  isResizing: false,\n  // modal z-index setting\n  zIndex: defaults.zIndex,\n};\n","import {\n  $D,\n  TOUCH_START_EVENT,\n  TOUCH_MOVE_EVENT,\n  TOUCH_END_EVENT,\n  EVENT_NS,\n  PUBLIC_VARS\n} from './constants';\n\nexport default {\n\n  /**\n   * [draggable]\n   * @param  {[Object]} modal       [the modal element]\n   * @param  {[Object]} dragHandle  [the handle element when dragging]\n   * @param  {[Object]} dragCancel  [the cancel element when dragging]\n   */\n  draggable(modal, dragHandle, dragCancel) {\n\n    let self = this;\n\n    let isDragging = false;\n\n    let startX = 0,\n      startY = 0,\n\n      left = 0,\n      top = 0;\n\n    let dragStart = function (e) {\n\n      e = e || window.event;\n\n      // Must be removed\n      // e.preventDefault();\n\n      if (self.options.multiInstances) {\n        modal.css('z-index', ++PUBLIC_VARS['zIndex']);\n      }\n\n      // Get clicked button\n      let elemCancel = $(e.target).closest(dragCancel);\n      // Stop modal moving when click buttons\n      if (elemCancel.length) {\n        return true;\n      }\n\n      isDragging = true;\n\n      startX = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageX : e.clientX;\n      startY = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageY : e.clientY;\n\n      left = $(modal).offset().left;\n      top = $(modal).offset().top;\n\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n    };\n\n    let dragMove = function (e) {\n\n      e = e || window.event;\n\n      e.preventDefault();\n\n      if (isDragging && !PUBLIC_VARS['isMoving'] && !PUBLIC_VARS['isResizing'] && !self.isMaximized) {\n\n        let endX = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageX : e.clientX,\n          endY = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageY : e.clientY,\n\n          relativeX = endX - startX,\n          relativeY = endY - startY;\n\n        $(modal).css({\n          left: relativeX + left + 'px',\n          top: relativeY + top + 'px'\n        });\n\n      }\n\n    };\n\n    let dragEnd = function () {\n\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n      isDragging = false;\n\n    };\n\n    $(dragHandle).on(TOUCH_START_EVENT + EVENT_NS, dragStart);\n\n  }\n\n}\n","import {\n  $D,\n  TOUCH_START_EVENT,\n  TOUCH_MOVE_EVENT,\n  TOUCH_END_EVENT,\n  NS,\n  EVENT_NS,\n  PUBLIC_VARS\n} from './constants';\n\nconst ELEMS_WITH_GRABBING_CURSOR = `html,body,.${NS}-modal,.${NS}-stage,.${NS}-button,.${NS}-resizable-handle`;\n\nexport default {\n\n  /**\n   * --------------------------------------\n   * 1.no movable\n   * 2.vertical movable\n   * 3.horizontal movable\n   * 4.vertical & horizontal movable\n   * --------------------------------------\n   *\n   * [image movable]\n   * @param  {[Object]} stage   [the stage element]\n   * @param  {[Object]} image   [the image element]\n   */\n  movable(stage, image) {\n\n    let self = this;\n\n    let isDragging = false;\n\n    let startX = 0,\n      startY = 0,\n\n      left = 0,\n      top = 0,\n\n      widthDiff = 0,\n      heightDiff = 0,\n\n      δ = 0;\n\n    let dragStart = function (e) {\n\n      e = e || window.event;\n\n      e.preventDefault();\n\n      let imageWidth = $(image).width(),\n        imageHeight = $(image).height(),\n        stageWidth = $(stage).width(),\n        stageHeight = $(stage).height();\n\n      startX = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageX : e.clientX;\n      startY = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageY : e.clientY;\n\n      // δ is the difference between image width and height\n      δ = !self.isRotated ? 0 : (imageWidth - imageHeight) / 2;\n\n      // Width or height difference can be use to limit image right or top position\n      widthDiff = !self.isRotated ? (imageWidth - stageWidth) : (imageHeight - stageWidth);\n      heightDiff = !self.isRotated ? (imageHeight - stageHeight) : (imageWidth - stageHeight);\n\n      // Modal can be dragging if image is smaller to stage\n      isDragging = (widthDiff > 0 || heightDiff > 0) ? true : false;\n      PUBLIC_VARS['isMoving'] = (widthDiff > 0 || heightDiff > 0) ? true : false;\n\n      // Reclac the element position when mousedown\n      // Fixed the issue of stage with a border\n      left = $(image).position().left - δ;\n      top = $(image).position().top + δ;\n\n      // Add grabbing cursor\n      if (stage.hasClass('is-grab')) {\n        $(ELEMS_WITH_GRABBING_CURSOR).addClass('is-grabbing');\n      }\n\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n    };\n\n    let dragMove = function (e) {\n\n      e = e || window.event;\n\n      e.preventDefault();\n\n      if (isDragging) {\n\n        let endX = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageX : e.clientX,\n          endY = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageY : e.clientY,\n\n          relativeX = endX - startX,\n          relativeY = endY - startY,\n\n          newLeft = relativeX + left,\n          newTop = relativeY + top;\n\n        // vertical limit\n        if (heightDiff > 0) {\n\n          if ((relativeY + top) > δ) {\n            newTop = δ;\n          } else if ((relativeY + top) < -heightDiff + δ) {\n            newTop = -heightDiff + δ;\n          }\n\n        } else {\n          newTop = top;\n        }\n        // horizontal limit\n        if (widthDiff > 0) {\n\n          if ((relativeX + left) > -δ) {\n            newLeft = -δ;\n          } else if ((relativeX + left) < -widthDiff - δ) {\n            newLeft = -widthDiff - δ;\n          }\n\n        } else {\n          newLeft = left;\n        }\n\n        $(image).css({\n          left: newLeft + 'px',\n          top: newTop + 'px'\n        });\n\n        // Update image initial data\n        $.extend(self.imageData, {\n          left: newLeft,\n          top: newTop\n        });\n\n      }\n\n    };\n\n    let dragEnd = function () {\n\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n      isDragging = false;\n      PUBLIC_VARS['isMoving'] = false;\n\n      // Remove grabbing cursor\n      $(ELEMS_WITH_GRABBING_CURSOR).removeClass('is-grabbing');\n\n    };\n\n    $(stage).on(TOUCH_START_EVENT + EVENT_NS, dragStart);\n\n  }\n\n}\n","import {\n  $D,\n  TOUCH_START_EVENT,\n  TOUCH_MOVE_EVENT,\n  TOUCH_END_EVENT,\n  NS,\n  EVENT_NS,\n  PUBLIC_VARS\n} from './constants';\n\nimport {\n  setGrabCursor\n} from './utilities';\n\nconst ELEMS_WITH_RESIZE_CURSOR = `html,body,.${NS}-modal,.${NS}-stage,.${NS}-button`;\n\nexport default {\n\n  /**\n   * ------------------------------\n   * 1.modal resizable\n   * 2.keep image in stage center\n   * 3.other image limitations\n   * ------------------------------\n   *\n   * [resizable]\n   * @param  {[Object]} modal       [the modal element]\n   * @param  {[Object]} stage       [the stage element]\n   * @param  {[Object]} image       [the image element]\n   * @param  {[Number]} minWidth    [the option of modalWidth]\n   * @param  {[Number]} minHeight   [the option of modalHeight]\n   */\n  resizable(modal, stage, image, minWidth, minHeight) {\n\n    let self = this;\n\n    let resizableHandleE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-e\"></div>`),\n      resizableHandleW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-w\"></div>`),\n      resizableHandleS = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-s\"></div>`),\n      resizableHandleN = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-n\"></div>`),\n      resizableHandleSE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-se\"></div>`),\n      resizableHandleSW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-sw\"></div>`),\n      resizableHandleNE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-ne\"></div>`),\n      resizableHandleNW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-nw\"></div>`);\n\n    let resizableHandles = {\n      'e': resizableHandleE,\n      's': resizableHandleS,\n      'se': resizableHandleSE,\n      'n': resizableHandleN,\n      'w': resizableHandleW,\n      'nw': resizableHandleNW,\n      'ne': resizableHandleNE,\n      'sw': resizableHandleSW\n    };\n\n    $(modal).append(\n      resizableHandleE, resizableHandleW, resizableHandleS, resizableHandleN,\n      resizableHandleSE, resizableHandleSW, resizableHandleNE, resizableHandleNW\n    );\n\n    let isDragging = false;\n\n    let startX = 0,\n      startY = 0,\n\n      modalData = {\n        w: 0,\n        h: 0,\n        l: 0,\n        t: 0\n      },\n      stageData = {\n        w: 0,\n        h: 0,\n        l: 0,\n        t: 0\n      },\n      imageData = {\n        w: 0,\n        h: 0,\n        l: 0,\n        t: 0\n      },\n\n      // δ is the difference between image width and height\n      δ = 0,\n      imgWidth = 0,\n      imgHeight = 0,\n\n      direction = '';\n\n    // modal CSS options\n    let getModalOpts = function (dir, offsetX, offsetY) {\n\n      // Modal should not move when its width to the minwidth\n      let modalLeft = (-offsetX + modalData.w) > minWidth ? (offsetX + modalData.l) : (modalData.l + modalData.w - minWidth),\n        modalTop = (-offsetY + modalData.h) > minHeight ? (offsetY + modalData.t) : (modalData.t + modalData.h - minHeight);\n\n      let opts = {\n        'e': {\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px'\n        },\n        's': {\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px'\n        },\n        'se': {\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px',\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px'\n        },\n        'w': {\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\n          left: modalLeft + 'px'\n        },\n        'n': {\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\n          top: modalTop + 'px'\n        },\n        'nw': {\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\n          top: modalTop + 'px',\n          left: modalLeft + 'px'\n        },\n        'ne': {\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px',\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\n          top: modalTop + 'px'\n        },\n        'sw': {\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px',\n          left: modalLeft + 'px'\n        }\n      };\n\n      return opts[dir];\n    };\n\n    // image CSS options\n    let getImageOpts = function (dir, offsetX, offsetY) {\n\n      // Image should not move when modal width to the min width\n      // The minwidth is modal width, so we should clac the stage minwidth\n      let widthDiff = (offsetX + modalData.w) > minWidth ? (stageData.w - imgWidth + offsetX - δ) : (minWidth - (modalData.w - stageData.w) - imgWidth - δ),\n        heightDiff = (offsetY + modalData.h) > minHeight ? (stageData.h - imgHeight + offsetY + δ) : (minHeight - (modalData.h - stageData.h) - imgHeight + δ),\n\n        widthDiff2 = (-offsetX + modalData.w) > minWidth ? (stageData.w - imgWidth - offsetX - δ) : (minWidth - (modalData.w - stageData.w) - imgWidth - δ),\n        heightDiff2 = (-offsetY + modalData.h) > minHeight ? (stageData.h - imgHeight - offsetY + δ) : (minHeight - (modalData.h - stageData.h) - imgHeight + δ);\n\n      // Get image position in dragging\n      let imgLeft = (widthDiff > 0 ? $(image).position().left : ($(image).position().left < 0 ? $(image).position().left : 0)) - δ,\n        imgTop = (heightDiff > 0 ? $(image).position().top : ($(image).position().top < 0 ? $(image).position().top : 0)) + δ,\n\n        imgLeft2 = (widthDiff2 > 0 ? $(image).position().left : ($(image).position().left < 0 ? $(image).position().left : 0)) - δ,\n        imgTop2 = (heightDiff2 > 0 ? $(image).position().top : ($(image).position().top < 0 ? $(image).position().top : 0)) + δ;\n\n      let opts = {\n        'e': {\n          left: widthDiff >= -δ ? ((widthDiff - δ) / 2 + 'px') : (imgLeft > widthDiff ? (imgLeft + 'px') : (widthDiff + 'px'))\n        },\n        's': {\n          top: heightDiff >= δ ? ((heightDiff + δ) / 2 + 'px') : (imgTop > heightDiff ? (imgTop + 'px') : (heightDiff + 'px'))\n        },\n        'se': {\n          top: heightDiff >= δ ? ((heightDiff + δ) / 2 + 'px') : (imgTop > heightDiff ? (imgTop + 'px') : (heightDiff + 'px')),\n          left: widthDiff >= -δ ? ((widthDiff - δ) / 2 + 'px') : (imgLeft > widthDiff ? (imgLeft + 'px') : (widthDiff + 'px'))\n        },\n        'w': {\n          left: widthDiff2 >= -δ ? ((widthDiff2 - δ) / 2 + 'px') : (imgLeft2 > widthDiff2 ? (imgLeft2 + 'px') : (widthDiff2 + 'px'))\n        },\n        'n': {\n          top: heightDiff2 >= δ ? ((heightDiff2 + δ) / 2 + 'px') : (imgTop2 > heightDiff2 ? (imgTop2 + 'px') : (heightDiff2 + 'px'))\n        },\n        'nw': {\n          top: heightDiff2 >= δ ? ((heightDiff2 + δ) / 2 + 'px') : (imgTop2 > heightDiff2 ? (imgTop2 + 'px') : (heightDiff2 + 'px')),\n          left: widthDiff2 >= -δ ? ((widthDiff2 - δ) / 2 + 'px') : (imgLeft2 > widthDiff2 ? (imgLeft2 + 'px') : (widthDiff2 + 'px'))\n        },\n        'ne': {\n          top: heightDiff2 >= δ ? ((heightDiff2 + δ) / 2 + 'px') : (imgTop2 > heightDiff2 ? (imgTop2 + 'px') : (heightDiff2 + 'px')),\n          left: widthDiff >= -δ ? ((widthDiff - δ) / 2 + 'px') : (imgLeft > widthDiff ? (imgLeft + 'px') : (widthDiff + 'px'))\n        },\n        'sw': {\n          top: heightDiff >= δ ? ((heightDiff + δ) / 2 + 'px') : (imgTop > heightDiff ? (imgTop + 'px') : (heightDiff + 'px')),\n          left: widthDiff2 >= -δ ? ((widthDiff2 - δ) / 2 + 'px') : (imgLeft2 > widthDiff2 ? (imgLeft2 + 'px') : (widthDiff2 + 'px'))\n        }\n      };\n\n      return opts[dir];\n    };\n\n    let dragStart = function (dir, e) {\n\n      e = e || window.event;\n\n      e.preventDefault();\n\n      isDragging = true;\n      PUBLIC_VARS['isResizing'] = true;\n\n      startX = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageX : e.clientX;\n      startY = e.type === 'touchstart' ? e.originalEvent.targetTouches[0].pageY : e.clientY;\n\n      // Reclac the modal data when mousedown\n      modalData = {\n        w: $(modal).width(),\n        h: $(modal).height(),\n        l: $(modal).offset().left,\n        t: $(modal).offset().top\n      };\n\n      stageData = {\n        w: $(stage).width(),\n        h: $(stage).height(),\n        l: $(stage).offset().left,\n        t: $(stage).offset().top\n      };\n\n      imageData = {\n        w: $(image).width(),\n        h: $(image).height(),\n        l: $(image).position().left,\n        t: $(image).position().top\n      };\n\n      // δ is the difference between image width and height\n      δ = !self.isRotated ? 0 : (imageData.w - imageData.h) / 2;\n      imgWidth = !self.isRotated ? imageData.w : imageData.h;\n      imgHeight = !self.isRotated ? imageData.h : imageData.w;\n\n      direction = dir;\n\n      // Add resizable cursor\n      $(ELEMS_WITH_RESIZE_CURSOR).css('cursor', dir + '-resize');\n\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n    };\n\n    let dragMove = function (e) {\n\n      e = e || window.event;\n\n      e.preventDefault();\n\n      if (isDragging && !self.isMaximized) {\n\n        let endX = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageX : e.clientX,\n          endY = e.type === 'touchmove' ? e.originalEvent.targetTouches[0].pageY : e.clientY,\n\n          relativeX = endX - startX,\n          relativeY = endY - startY;\n\n        let modalOpts = getModalOpts(direction, relativeX, relativeY);\n\n        $(modal).css(modalOpts);\n\n        let imageOpts = getImageOpts(direction, relativeX, relativeY);\n\n        $(image).css(imageOpts);\n\n      }\n\n    };\n\n    let dragEnd = function () {\n\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\n\n      // Set grab cursor\n      if (PUBLIC_VARS['isResizing']) {\n        setGrabCursor({ w: imgWidth, h: imgHeight }, { w: $(stage).width(), h: $(stage).height() },\n          stage\n        );\n      }\n\n      isDragging = false;\n      PUBLIC_VARS['isResizing'] = false;\n\n      // Remove resizable cursor\n      $(ELEMS_WITH_RESIZE_CURSOR).css('cursor', '');\n\n    };\n\n    $.each(resizableHandles, function (dir, handle) {\n      handle.on(TOUCH_START_EVENT + EVENT_NS, function (e) {\n        dragStart(dir, e);\n      });\n    });\n\n  }\n\n}\n","import $ from 'jquery';\r\n\r\nimport DEFAULTS from './defaults';\r\n\r\nimport {\r\n  $W,\r\n  $D,\r\n  CLICK_EVENT,\r\n  RESIZE_EVENT,\r\n  KEYDOWN_EVENT,\r\n  WHEEL_EVENT,\r\n  NS,\r\n  CLASS_NS,\r\n  EVENT_NS,\r\n  PUBLIC_VARS\r\n} from './constants';\r\n\r\nimport {\r\n  getImgSrc,\r\n  throttle,\r\n  preloadImg,\r\n  requestFullscreen,\r\n  getImageNameFromUrl,\r\n  getNumFromCSSValue,\r\n  hasScrollbar,\r\n  getScrollbarWidth,\r\n  setGrabCursor\r\n} from './utilities';\r\n\r\nimport draggable from './draggable';\r\nimport movable from './movable';\r\nimport resizable from './resizable';\r\n\r\n/**\r\n * PhotoViewer Class\r\n */\r\nclass PhotoViewer {\r\n\r\n  constructor(items, options, el) {\r\n\r\n    let self = this;\r\n\r\n    this.options = $.extend(true, {}, DEFAULTS, options);\r\n\r\n    if (options && $.isArray(options.footToolbar)) {\r\n      this.options.footToolbar = options.footToolbar;\r\n    }\r\n\r\n    if (options && $.isArray(options.headToolbar)) {\r\n      this.options.headToolbar = options.headToolbar;\r\n    }\r\n\r\n    // Store element of clicked\r\n    this.$el = $(el);\r\n\r\n    // As we have multiple instances,\r\n    // so every instance has following variables.\r\n\r\n    // modal open flag\r\n    this.isOpened = false;\r\n    // modal maximize flag\r\n    this.isMaximized = false;\r\n    // image rotate 90*(2n+1) flag\r\n    this.isRotated = false;\r\n    // image rotate angle\r\n    this.rotateAngle = 0;\r\n\r\n    // Store image data in every instance\r\n    this.imageData = {};\r\n    // Store modal data in every instance\r\n    this.modalData = {\r\n      width: null,\r\n      height: null,\r\n      left: null,\r\n      top: null\r\n    };\r\n\r\n    this.init(items, self.options, el);\r\n\r\n  }\r\n\r\n  init(items, opts, el) {\r\n\r\n    this.groupData = items;\r\n    this.groupIndex = opts['index'];\r\n\r\n    // Get image src\r\n    let imgSrc = items[this.groupIndex]['src'];\r\n\r\n    this.open();\r\n\r\n    this.loadImg(imgSrc);\r\n\r\n    // draggable & movable & resizable\r\n    if (opts.draggable) {\r\n      this.draggable(this.$photoviewer, this.dragHandle, CLASS_NS + '-button');\r\n    }\r\n    if (opts.movable) {\r\n      this.movable(this.$stage, this.$image);\r\n    }\r\n    if (opts.resizable) {\r\n      this.resizable(this.$photoviewer, this.$stage, this.$image, opts.modalWidth, opts.modalHeight);\r\n    }\r\n\r\n  }\r\n\r\n  _creatBtns(toolbar, btns) {\r\n\r\n    let btnsStr = '';\r\n\r\n    $.each(toolbar, function (index, item) {\r\n      btnsStr += btns[item];\r\n    });\r\n\r\n    return btnsStr;\r\n\r\n  }\r\n\r\n  _creatTitle() {\r\n    return (this.options.title ? `<div class=\"${NS}-title\"></div>` : '');\r\n  }\r\n\r\n  _creatDOM() {\r\n\r\n    let btnsTpl = {\r\n      minimize: `<button class=\"${NS}-button ${NS}-button-minimize\" title=\"${this.options.i18n.minimize}\">\r\n                    ${this.options.icons.minimize}\r\n                  </button>`,\r\n      maximize: `<button class=\"${NS}-button ${NS}-button-maximize\" title=\"${this.options.i18n.maximize}\">\r\n                    ${this.options.icons.maximize}\r\n                  </button>`,\r\n      close: `<button class=\"${NS}-button ${NS}-button-close\" title=\"${this.options.i18n.close}\">\r\n                ${this.options.icons.close}\r\n              </button>`,\r\n      zoomIn: `<button class=\"${NS}-button ${NS}-button-zoom-in\" title=\"${this.options.i18n.zoomIn}\">\r\n                  ${this.options.icons.zoomIn}\r\n                </button>`,\r\n      zoomOut: `<button class=\"${NS}-button ${NS}-button-zoom-out\" title=\"${this.options.i18n.zoomOut}\">\r\n                  ${this.options.icons.zoomOut}\r\n                </button>`,\r\n      prev: `<button class=\"${NS}-button ${NS}-button-prev\" title=\"${this.options.i18n.prev}\">\r\n                ${this.options.icons.prev}\r\n              </button>`,\r\n      next: `<button class=\"${NS}-button ${NS}-button-next\" title=\"${this.options.i18n.next}\">\r\n                ${this.options.icons.next}\r\n              </button>`,\r\n      fullscreen: `<button class=\"${NS}-button ${NS}-button-fullscreen\" title=\"${this.options.i18n.fullscreen}\">\r\n                    ${this.options.icons.fullscreen}\r\n                  </button>`,\r\n      actualSize: `<button class=\"${NS}-button ${NS}-button-actual-size\" title=\"${this.options.i18n.actualSize}\">\r\n                      ${this.options.icons.actualSize}\r\n                    </button>`,\r\n      rotateLeft: `<button class=\"${NS}-button ${NS}-button-rotate-left\" title=\"${this.options.i18n.rotateLeft}\">\r\n                      ${this.options.icons.rotateLeft}\r\n                    </button>`,\r\n      rotateRight: `<button class=\"${NS}-button ${NS}-button-rotate-right\" title=\"${this.options.i18n.rotateRight}\">\r\n                      ${this.options.icons.rotateRight}\r\n                    </button>`\r\n    };\r\n\r\n    // photoviewer base HTML\r\n    let photoviewerHTML = `<div class=\"${NS}-modal\">\r\n                            <div class=\"${NS}-inner\">\r\n                              <div class=\"${NS}-header\">\r\n                                <div class=\"${NS}-toolbar ${NS}-toolbar-head\">\r\n                                  ${this._creatBtns(this.options.headToolbar, btnsTpl)}\r\n                                </div>\r\n                                ${this._creatTitle()}\r\n                              </div>\r\n                              <div class=\"${NS}-stage\">\r\n                                <img class=\"${NS}-image\" src=\"\" alt=\"\" />\r\n                              </div>\r\n                              <div class=\"${NS}-footer\">\r\n                                <div class=\"${NS}-toolbar ${NS}-toolbar-foot\">\r\n                                  ${this._creatBtns(this.options.footToolbar, btnsTpl)}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>`;\r\n\r\n    return photoviewerHTML;\r\n\r\n  }\r\n\r\n  build() {\r\n\r\n    // Create photoviewer HTML string\r\n    let photoviewerHTML = this._creatDOM();\r\n\r\n    // Make photoviewer HTML string to jQuery element\r\n    let $photoviewer = $(photoviewerHTML);\r\n\r\n    // Get all photoviewer element\r\n    this.$photoviewer = $photoviewer;\r\n    this.$header = $photoviewer.find(CLASS_NS + '-header');\r\n    this.$headToolbar = $photoviewer.find(CLASS_NS + '-toolbar-head');\r\n    this.$footer = $photoviewer.find(CLASS_NS + '-footer');\r\n    this.$footToolbar = $photoviewer.find(CLASS_NS + '-toolbar-foot');\r\n    this.$stage = $photoviewer.find(CLASS_NS + '-stage');\r\n    this.$title = $photoviewer.find(CLASS_NS + '-title');\r\n    this.$image = $photoviewer.find(CLASS_NS + '-image');\r\n    this.$close = $photoviewer.find(CLASS_NS + '-button-close');\r\n    this.$maximize = $photoviewer.find(CLASS_NS + '-button-maximize');\r\n    this.$minimize = $photoviewer.find(CLASS_NS + '-button-minimize');\r\n    this.$zoomIn = $photoviewer.find(CLASS_NS + '-button-zoom-in');\r\n    this.$zoomOut = $photoviewer.find(CLASS_NS + '-button-zoom-out');\r\n    this.$actualSize = $photoviewer.find(CLASS_NS + '-button-actual-size');\r\n    this.$fullscreen = $photoviewer.find(CLASS_NS + '-button-fullscreen');\r\n    this.$rotateLeft = $photoviewer.find(CLASS_NS + '-button-rotate-left');\r\n    this.$rotateRight = $photoviewer.find(CLASS_NS + '-button-rotate-right');\r\n    this.$prev = $photoviewer.find(CLASS_NS + '-button-prev');\r\n    this.$next = $photoviewer.find(CLASS_NS + '-button-next');\r\n\r\n    // Add class before image loaded\r\n    this.$stage.addClass('stage-ready');\r\n    this.$image.addClass('image-ready');\r\n\r\n    // Reset modal z-index with multiple instances\r\n    this.$photoviewer.css('z-index', PUBLIC_VARS['zIndex']);\r\n\r\n    // Set handle element of draggable\r\n    if (!this.options.dragHandle || this.options.dragHandle === CLASS_NS + '-modal') {\r\n      this.dragHandle = this.$photoviewer;\r\n    } else {\r\n      this.dragHandle = this.$photoviewer.find(this.options.dragHandle);\r\n    }\r\n\r\n  }\r\n\r\n  open() {\r\n\r\n    if (!this.options.multiInstances) {\r\n      $(CLASS_NS + '-modal').eq(0).remove();\r\n    }\r\n\r\n    // Fixed modal position bug\r\n    if (!$(CLASS_NS + '-modal').length && this.options.fixedContent) {\r\n\r\n      $('html').css({ 'overflow': 'hidden' });\r\n\r\n      if (hasScrollbar()) {\r\n        let scrollbarWidth = getScrollbarWidth();\r\n        if (scrollbarWidth) {\r\n          $('html').css({ 'padding-right': scrollbarWidth });\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    this.build();\r\n\r\n    this._triggerHook('beforeOpen', this.$el);\r\n\r\n    // Add PhotoViewer to DOM\r\n    $('body').append(this.$photoviewer);\r\n\r\n    this.addEvents();\r\n\r\n    this.setModalPos(this.$photoviewer);\r\n\r\n    this._triggerHook('opened', this.$el);\r\n\r\n  }\r\n\r\n  close() {\r\n\r\n    this._triggerHook('beforeClose', this.$el);\r\n\r\n    // Remove instance\r\n    this.$photoviewer.remove();\r\n\r\n    this.isOpened = false;\r\n    this.isMaximized = false;\r\n    this.isRotated = false;\r\n    this.rotateAngle = 0;\r\n\r\n    let zeroModal = !$(CLASS_NS + '-modal').length;\r\n\r\n    // Fixed modal position bug\r\n    if (zeroModal && this.options.fixedContent) {\r\n      $('html').css({ 'overflow': '', 'padding-right': '' });\r\n    }\r\n\r\n    // Reset zIndex after close\r\n    if (zeroModal && this.options.multiInstances) {\r\n      PUBLIC_VARS['zIndex'] = this.options.zIndex;\r\n    }\r\n\r\n    // off events\r\n    if (!$(CLASS_NS + '-modal').length) {\r\n      $D.off(KEYDOWN_EVENT + EVENT_NS);\r\n      $W.off(RESIZE_EVENT + EVENT_NS);\r\n    }\r\n\r\n    this._triggerHook('closed', this.$el);\r\n\r\n  }\r\n\r\n  setModalPos(modal) {\r\n\r\n    let winWidth = $W.width(),\r\n      winHeight = $W.height(),\r\n      scrollLeft = $D.scrollLeft(),\r\n      scrollTop = $D.scrollTop();\r\n\r\n    let modalWidth = this.options.modalWidth,\r\n      modalHeight = this.options.modalHeight;\r\n\r\n    // Set modal maximized when init\r\n    if (this.options.initMaximized) {\r\n\r\n      modal.addClass(NS + '-maximize');\r\n\r\n      modal.css({\r\n        width: '100%',\r\n        height: '100%',\r\n        left: 0,\r\n        top: 0\r\n      });\r\n\r\n      this.isOpened = true;\r\n      this.isMaximized = true;\r\n\r\n    } else {\r\n\r\n      // Make the modal in windows center\r\n      modal.css({\r\n        width: modalWidth,\r\n        height: modalHeight,\r\n        left: (winWidth - modalWidth) / 2 + scrollLeft + 'px',\r\n        top: (winHeight - modalHeight) / 2 + scrollTop + 'px'\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n\r\n  setModalSize(img) {\r\n\r\n    let self = this,\r\n      winWidth = $W.width(),\r\n      winHeight = $W.height(),\r\n      scrollLeft = $D.scrollLeft(),\r\n      scrollTop = $D.scrollTop();\r\n\r\n    // stage css value\r\n    let stageCSS = {\r\n      left: this.$stage.css('left'),\r\n      right: this.$stage.css('right'),\r\n      top: this.$stage.css('top'),\r\n      bottom: this.$stage.css('bottom'),\r\n      borderLeft: this.$stage.css('border-left-width'),\r\n      borderRight: this.$stage.css('border-right-width'),\r\n      borderTop: this.$stage.css('border-top-width'),\r\n      borderBottom: this.$stage.css('border-bottom-width')\r\n    };\r\n\r\n    // Modal size should calc with stage css value\r\n    let modalWidth = img.width + getNumFromCSSValue(stageCSS.left) + getNumFromCSSValue(stageCSS.right) +\r\n      getNumFromCSSValue(stageCSS.borderLeft) + getNumFromCSSValue(stageCSS.borderRight),\r\n      modalHeight = img.height + getNumFromCSSValue(stageCSS.top) + getNumFromCSSValue(stageCSS.bottom) +\r\n        getNumFromCSSValue(stageCSS.borderTop) + getNumFromCSSValue(stageCSS.borderBottom);\r\n\r\n    let gapThreshold = (this.options.gapThreshold > 0 ? this.options.gapThreshold : 0) + 1,\r\n      // modal scale to window\r\n      scale = Math.min(winWidth / (modalWidth * gapThreshold), winHeight / (modalHeight * gapThreshold), 1);\r\n\r\n    let minWidth = Math.max(modalWidth * scale, this.options.modalWidth),\r\n      minHeight = Math.max(modalHeight * scale, this.options.modalHeight);\r\n\r\n    minWidth = this.options.fixedModalSize ? this.options.modalWidth : Math.round(minWidth);\r\n    minHeight = this.options.fixedModalSize ? this.options.modalHeight : Math.round(minHeight);\r\n\r\n    let modalCSSObj = {\r\n      width: minWidth + 'px',\r\n      height: minHeight + 'px',\r\n      left: (winWidth - minWidth) / 2 + scrollLeft + 'px',\r\n      top: (winHeight - minHeight) / 2 + scrollTop + 'px'\r\n    };\r\n\r\n    // Add modal init animation\r\n    if (this.options.initAnimation) {\r\n\r\n      this.$photoviewer.animate(modalCSSObj, function () {\r\n        self.setImageSize(img);\r\n      });\r\n\r\n    } else {\r\n\r\n      this.$photoviewer.css(modalCSSObj);\r\n      this.setImageSize(img);\r\n\r\n    }\r\n\r\n    this.isOpened = true;\r\n\r\n  }\r\n\r\n  setImageSize(img) {\r\n\r\n    let stageData = {\r\n      w: this.$stage.width(),\r\n      h: this.$stage.height()\r\n    };\r\n\r\n    // image scale to stage\r\n    let scale = 1;\r\n\r\n    if (!this.isRotated) {\r\n      scale = Math.min(stageData.w / img.width, stageData.h / img.height, 1);\r\n    } else {\r\n      scale = Math.min(stageData.w / img.height, stageData.h / img.width, 1);\r\n    }\r\n\r\n    this.$image.css({\r\n      width: Math.ceil(img.width * scale) + 'px',\r\n      height: Math.ceil(img.height * scale) + 'px',\r\n      left: (stageData.w - Math.ceil(img.width * scale)) / 2 + 'px',\r\n      top: (stageData.h - Math.ceil(img.height * scale)) / 2 + 'px'\r\n    });\r\n\r\n    // Store image initial data\r\n    $.extend(this.imageData, {\r\n      width: img.width * scale,\r\n      height: img.height * scale,\r\n      left: (stageData.w - img.width * scale) / 2,\r\n      top: (stageData.h - img.height * scale) / 2\r\n    });\r\n\r\n    // Set grab cursor\r\n    setGrabCursor({ w: this.$image.width(), h: this.$image.height() }, { w: this.$stage.width(), h: this.$stage.height() },\r\n      this.$stage,\r\n      this.isRotated\r\n    );\r\n\r\n    // loader end\r\n    this.$photoviewer.find(CLASS_NS + '-loader').remove();\r\n\r\n    // Add image init animation\r\n    if (this.options.initAnimation) {\r\n      this.$image.fadeIn();\r\n    }\r\n\r\n  }\r\n\r\n  loadImg(imgSrc) {\r\n\r\n    let self = this;\r\n\r\n    let loaderHTML = `<div class=\"${NS}-loader\"></div>`;\r\n\r\n    // loader start\r\n    this.$photoviewer.append(loaderHTML);\r\n\r\n    if (this.options.initAnimation) {\r\n      this.$image.hide();\r\n    }\r\n\r\n    this.$image.attr('src', imgSrc);\r\n\r\n    preloadImg(imgSrc, function (img) {\r\n\r\n      // Store original data\r\n      self.imageData = {\r\n        originalWidth: img.width,\r\n        originalHeight: img.height\r\n      };\r\n\r\n      if (self.isMaximized || (self.isOpened && self.options.fixedModalPos)) {\r\n        self.setImageSize(img);\r\n      } else {\r\n        self.setModalSize(img);\r\n      }\r\n\r\n      self.$stage.removeClass('stage-ready');\r\n      self.$image.removeClass('image-ready');\r\n\r\n    }, function () {\r\n      // loader end\r\n      self.$photoviewer.find(CLASS_NS + '-loader').remove();\r\n    });\r\n\r\n    if (this.options.title) {\r\n      this.setImgTitle(imgSrc);\r\n    }\r\n\r\n  }\r\n\r\n  setImgTitle(url) {\r\n\r\n    let caption = this.groupData[this.groupIndex].caption,\r\n      captionTxt = caption ? caption : getImageNameFromUrl(url);\r\n\r\n    this.$title.html(captionTxt);\r\n\r\n  }\r\n\r\n  jump(index) {\r\n\r\n    this.groupIndex = this.groupIndex + index;\r\n\r\n    this.jumpTo(this.groupIndex);\r\n\r\n  }\r\n\r\n  jumpTo(index) {\r\n\r\n    index = index % this.groupData.length;\r\n\r\n    if (index >= 0) {\r\n      index = index % this.groupData.length;\r\n    } else if (index < 0) {\r\n      index = (this.groupData.length + index) % this.groupData.length;\r\n    }\r\n\r\n    this.groupIndex = index;\r\n\r\n    this._triggerHook('beforeChange', index);\r\n\r\n    this.loadImg(this.groupData[index].src);\r\n\r\n    this._triggerHook('changed', index);\r\n\r\n  }\r\n\r\n  wheel(e) {\r\n\r\n    e.preventDefault();\r\n\r\n    let delta = 1;\r\n\r\n    if (e.originalEvent.deltaY) {\r\n      delta = e.originalEvent.deltaY > 0 ? 1 : -1;\r\n    } else if (e.originalEvent.wheelDelta) {\r\n      delta = -e.originalEvent.wheelDelta / 120;\r\n    } else if (e.originalEvent.detail) {\r\n      delta = e.originalEvent.detail > 0 ? 1 : -1;\r\n    }\r\n\r\n    // ratio threshold\r\n    let ratio = -delta * this.options.ratioThreshold;\r\n\r\n    // mouse point position relative to stage\r\n    let pointer = {\r\n      x: e.originalEvent.clientX - this.$stage.offset().left + $D.scrollLeft(),\r\n      y: e.originalEvent.clientY - this.$stage.offset().top + $D.scrollTop()\r\n    };\r\n\r\n    this.zoom(ratio, pointer, e);\r\n\r\n  }\r\n\r\n  zoom(ratio, origin, e) {\r\n\r\n    // zoom out & zoom in\r\n    ratio = ratio < 0 ? (1 / (1 - ratio)) : (1 + ratio);\r\n\r\n    if (ratio > 0.95 && ratio < 1.05) {\r\n      ratio = 1;\r\n    }\r\n\r\n    ratio = this.$image.width() / this.imageData.originalWidth * ratio;\r\n\r\n    // min image size\r\n    ratio = Math.max(ratio, this.options.minRatio);\r\n    // max image size\r\n    ratio = Math.min(ratio, this.options.maxRatio);\r\n\r\n    this.zoomTo(ratio, origin, e);\r\n\r\n  }\r\n\r\n  zoomTo(ratio, origin, e) {\r\n\r\n    let $image = this.$image,\r\n      $stage = this.$stage,\r\n      imgData = {\r\n        w: this.imageData.width,\r\n        h: this.imageData.height,\r\n        x: this.imageData.left,\r\n        y: this.imageData.top\r\n      };\r\n\r\n    // image stage position\r\n    // We will use it to calc the relative position of image\r\n    let stageData = {\r\n      w: $stage.width(),\r\n      h: $stage.height(),\r\n      x: $stage.offset().left,\r\n      y: $stage.offset().top\r\n    };\r\n\r\n    let newWidth = this.imageData.originalWidth * ratio,\r\n      newHeight = this.imageData.originalHeight * ratio,\r\n      // Think about it for a while ~~~\r\n      newLeft = origin.x - (origin.x - imgData.x) / imgData.w * newWidth,\r\n      newTop = origin.y - (origin.y - imgData.y) / imgData.h * newHeight;\r\n\r\n    // δ is the difference between image new width and new height\r\n    let δ = !this.isRotated ? 0 : (newWidth - newHeight) / 2,\r\n      imgNewWidth = !this.isRotated ? newWidth : newHeight,\r\n      imgNewHeight = !this.isRotated ? newHeight : newWidth;\r\n\r\n    let offsetX = stageData.w - newWidth,\r\n      offsetY = stageData.h - newHeight;\r\n\r\n    // zoom out & zoom in condition\r\n    // It's important and it takes me a lot of time to get it\r\n    // The conditions with image rotate 90 degree drive me crazy alomst!\r\n    if (imgNewHeight <= stageData.h) {\r\n      newTop = (stageData.h - newHeight) / 2;\r\n    } else {\r\n      newTop = newTop > δ ? δ : (newTop > (offsetY - δ) ? newTop : (offsetY - δ));\r\n    }\r\n\r\n    if (imgNewWidth <= stageData.w) {\r\n      newLeft = (stageData.w - newWidth) / 2;\r\n    } else {\r\n      newLeft = newLeft > -δ ? -δ : (newLeft > (offsetX + δ) ? newLeft : (offsetX + δ));\r\n    }\r\n\r\n    $image.css({\r\n      width: Math.round(newWidth) + 'px',\r\n      height: Math.round(newHeight) + 'px',\r\n      left: Math.round(newLeft) + 'px',\r\n      top: Math.round(newTop) + 'px'\r\n    });\r\n\r\n    // Update image initial data\r\n    $.extend(this.imageData, {\r\n      width: newWidth,\r\n      height: newHeight,\r\n      left: newLeft,\r\n      top: newTop\r\n    });\r\n\r\n    // Set grab cursor\r\n    setGrabCursor({ w: Math.round(imgNewWidth), h: Math.round(imgNewHeight) }, { w: stageData.w, h: stageData.h },\r\n      this.$stage\r\n    );\r\n\r\n  }\r\n\r\n  rotate(angle) {\r\n\r\n    this.rotateAngle = this.rotateAngle + angle;\r\n\r\n    if ((this.rotateAngle / 90) % 2 === 0) {\r\n      this.isRotated = false;\r\n    } else {\r\n      this.isRotated = true;\r\n    }\r\n\r\n    this.rotateTo(this.rotateAngle);\r\n\r\n  }\r\n\r\n  rotateTo(angle) {\r\n\r\n    let self = this;\r\n\r\n    this.$image.css({\r\n      transform: 'rotate(' + angle + 'deg)'\r\n    });\r\n\r\n    this.setImageSize({ width: this.imageData.originalWidth, height: this.imageData.originalHeight });\r\n\r\n    // Remove grab cursor when rotate\r\n    this.$stage.removeClass('is-grab');\r\n\r\n  }\r\n\r\n  resize() {\r\n\r\n    let self = this;\r\n\r\n    let resizeHandler = throttle(function () {\r\n\r\n      if (self.isOpened) {\r\n\r\n        if (self.isMaximized) {\r\n          self.setImageSize({ width: self.imageData.originalWidth, height: self.imageData.originalHeight });\r\n        } else {\r\n          self.setModalSize({ width: self.imageData.originalWidth, height: self.imageData.originalHeight });\r\n        }\r\n\r\n      }\r\n\r\n    }, 500);\r\n\r\n    return resizeHandler;\r\n\r\n  }\r\n\r\n  maximize() {\r\n\r\n    let self = this;\r\n\r\n    if (!this.isMaximized) {\r\n      // Store modal data before maximize\r\n      this.modalData = {\r\n        width: this.$photoviewer.width(),\r\n        height: this.$photoviewer.height(),\r\n        left: this.$photoviewer.offset().left,\r\n        top: this.$photoviewer.offset().top\r\n      };\r\n\r\n      this.$photoviewer.addClass(NS + '-maximize');\r\n\r\n      this.$photoviewer.css({\r\n        width: '100%',\r\n        height: '100%',\r\n        left: 0,\r\n        top: 0\r\n      });\r\n\r\n      this.isMaximized = true;\r\n\r\n    } else {\r\n\r\n      this.$photoviewer.removeClass(NS + '-maximize');\r\n\r\n      this.$photoviewer.css({\r\n        width: this.modalData.width ? this.modalData.width : this.options.modalWidth,\r\n        height: this.modalData.height ? this.modalData.height : this.options.modalHeight,\r\n        left: this.modalData.left ? this.modalData.left : ($W.width() - this.options.modalWidth) / 2 + $D.scrollLeft(),\r\n        top: this.modalData.top ? this.modalData.top : ($W.height() - this.options.modalHeight) / 2 + $D.scrollTop()\r\n      });\r\n\r\n      this.isMaximized = false;\r\n    }\r\n\r\n    this.setImageSize({ width: this.imageData.originalWidth, height: this.imageData.originalHeight });\r\n\r\n  }\r\n\r\n  fullscreen() {\r\n\r\n    requestFullscreen(this.$photoviewer[0]);\r\n\r\n  }\r\n\r\n  keydown(e) {\r\n\r\n    let self = this;\r\n\r\n    if (!this.options.keyboard) {\r\n      return false;\r\n    }\r\n\r\n    let keyCode = e.keyCode || e.which || e.charCode,\r\n      ctrlKey = e.ctrlKey || e.metaKey,\r\n      altKey = e.altKey || e.metaKey;\r\n\r\n    switch (keyCode) {\r\n      // ←\r\n      case 37:\r\n        self.jump(-1);\r\n        break;\r\n      // →\r\n      case 39:\r\n        self.jump(1);\r\n        break;\r\n      // +\r\n      case 187:\r\n        self.zoom(self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n        break;\r\n      // -\r\n      case 189:\r\n        self.zoom(-self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n        break;\r\n      // + Firefox\r\n      case 61:\r\n        self.zoom(self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n        break;\r\n      // - Firefox\r\n      case 173:\r\n        self.zoom(-self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n        break;\r\n      // ctrl + alt + 0\r\n      case 48:\r\n        if (ctrlKey && altKey) {\r\n          self.zoomTo(1, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n        }\r\n        break;\r\n      // ctrl + ,\r\n      case 188:\r\n        if (ctrlKey) {\r\n          self.rotate(-90);\r\n        }\r\n        break;\r\n      // ctrl + .\r\n      case 190:\r\n        if (ctrlKey) {\r\n          self.rotate(90);\r\n        }\r\n        break;\r\n      default:\r\n    }\r\n\r\n  }\r\n\r\n  addEvents() {\r\n\r\n    let self = this;\r\n\r\n    this.$close.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\r\n      self.close();\r\n    });\r\n\r\n    this.$stage.off(WHEEL_EVENT + EVENT_NS).on(WHEEL_EVENT + EVENT_NS, function (e) {\r\n      self.wheel(e);\r\n    });\r\n\r\n    this.$zoomIn.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\r\n      self.zoom(self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n    });\r\n\r\n    this.$zoomOut.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\r\n      self.zoom(-self.options.ratioThreshold * 3, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n    });\r\n\r\n    this.$actualSize.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\r\n      self.zoomTo(1, { x: self.$stage.width() / 2, y: self.$stage.height() / 2 }, e);\r\n    });\r\n\r\n    this.$prev.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.jump(-1);\r\n    });\r\n\r\n    this.$fullscreen.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.fullscreen();\r\n    });\r\n\r\n    this.$next.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.jump(1);\r\n    });\r\n\r\n    this.$rotateLeft.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.rotate(-90);\r\n    });\r\n\r\n    this.$rotateRight.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.rotate(90);\r\n    });\r\n\r\n    this.$maximize.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function () {\r\n      self.maximize();\r\n    });\r\n\r\n    $D.off(KEYDOWN_EVENT + EVENT_NS).on(KEYDOWN_EVENT + EVENT_NS, function (e) {\r\n      self.keydown(e);\r\n    });\r\n\r\n    $W.on(RESIZE_EVENT + EVENT_NS, self.resize());\r\n\r\n  }\r\n\r\n  _triggerHook(e, data) {\r\n    if (this.options.callbacks[e]) {\r\n      this.options.callbacks[e].apply(this, $.isArray(data) ? data : [data]);\r\n    }\r\n  }\r\n\r\n\r\n}\r\n\r\n/**\r\n * Add methods to PhotoViewer\r\n */\r\n$.extend(PhotoViewer.prototype, draggable, movable, resizable);\r\n\r\n/**\r\n * Add PhotoViewer to globle\r\n */\r\nwindow.PhotoViewer = PhotoViewer;\r\n\r\n/**\r\n * jQuery plugin\r\n */\r\n\r\nlet jqEl = null,\r\n  getImgGroup = function (list, groupName) {\r\n\r\n    let items = [];\r\n\r\n    $(list).each(function () {\r\n\r\n      let src = getImgSrc(this);\r\n\r\n      items.push({\r\n        src: src,\r\n        caption: $(this).attr('data-caption'),\r\n        groupName: groupName\r\n      });\r\n\r\n    });\r\n\r\n    return items;\r\n\r\n  }\r\n\r\n$.fn.photoviewer = function (options) {\r\n\r\n  jqEl = $(this);\r\n\r\n  options = options ? options : {};\r\n\r\n  // Convert a numeric string into a number\r\n  for (let key in options) {\r\n    if (typeof (options[key]) === 'string' && !isNaN(options[key])) {\r\n      options[key] = parseFloat(options[key])\r\n    }\r\n  }\r\n\r\n  // Get init event, 'click' or 'dblclick'\r\n  let opts = $.extend(true, {}, DEFAULTS, options);\r\n\r\n  // We should get zIndex of options before plugin's init.\r\n  PUBLIC_VARS['zIndex'] = opts.zIndex;\r\n\r\n  if (typeof options === 'string') {\r\n\r\n    // $(this).data('photoviewer')[options]();\r\n\r\n  } else {\r\n\r\n    jqEl.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\r\n\r\n      e.preventDefault();\r\n      // This will stop triggering data-api event\r\n      e.stopPropagation();\r\n\r\n      // Get image group\r\n      let items = [],\r\n        currentGroupName = $(this).attr('data-group'),\r\n        groupList = $D.find('[data-group=\"' + currentGroupName + '\"]');\r\n\r\n      if (currentGroupName !== undefined) {\r\n        items = getImgGroup(groupList, currentGroupName);\r\n        options['index'] = $(this).index('[data-group=\"' + currentGroupName + '\"]');\r\n      } else {\r\n        items = getImgGroup(jqEl.not('[data-group]'));\r\n        options['index'] = $(this).index();\r\n      }\r\n\r\n      $(this).data(NS, new PhotoViewer(items, options, this));\r\n\r\n    });\r\n\r\n  }\r\n\r\n  return jqEl;\r\n\r\n};\r\n\r\n/**\r\n * PhotoViewer DATA-API\r\n */\r\n$D.on(CLICK_EVENT + EVENT_NS, '[data-' + NS + ']', function (e) {\r\n\r\n  jqEl = $('[data-' + NS + ']');\r\n\r\n  e.preventDefault();\r\n\r\n  // Get image group\r\n  let items = [],\r\n    currentGroupName = $(this).attr('data-group'),\r\n    groupList = $D.find('[data-group=\"' + currentGroupName + '\"]');\r\n\r\n  if (currentGroupName !== undefined) {\r\n    items = getImgGroup(groupList, currentGroupName);\r\n    DEFAULTS['index'] = $(this).index('[data-group=\"' + currentGroupName + '\"]');\r\n  } else {\r\n    items = getImgGroup(jqEl.not('[data-group]'));\r\n    DEFAULTS['index'] = $(this).index();\r\n  }\r\n\r\n  $(this).data(NS, new PhotoViewer(items, DEFAULTS, this));\r\n\r\n});\r\n\r\nexport default PhotoViewer;\r\n"],"names":["$","noop","getImgSrc","el","src","attr","throttle","fn","delay","timer","context","args","arguments","setTimeout","apply","preloadImg","success","error","img","Image","onload","onerror","requestFullscreen","element","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","getImageNameFromUrl","url","reg","txt","replace","getNumFromCSSValue","value","arr","match","num","parseFloat","hasScrollbar","document","body","scrollHeight","window","innerHeight","documentElement","clientHeight","getScrollbarWidth","scrollDiv","createElement","style","cssText","appendChild","scrollbarWidth","offsetWidth","clientWidth","removeChild","setGrabCursor","imageData","stageData","stage","isRotated","imageWidth","w","h","imageHeight","addClass","removeClass","supportTouch","DocumentTouch","$W","$D","CLICK_EVENT","RESIZE_EVENT","KEYDOWN_EVENT","WHEEL_EVENT","TOUCH_START_EVENT","TOUCH_MOVE_EVENT","TOUCH_END_EVENT","NS","CLASS_NS","EVENT_NS","PUBLIC_VARS","defaults","zIndex","modal","dragHandle","dragCancel","self","isDragging","startX","startY","left","top","dragStart","e","event","options","multiInstances","css","elemCancel","target","closest","length","type","originalEvent","targetTouches","pageX","clientX","pageY","clientY","offset","on","dragMove","dragEnd","preventDefault","isMaximized","endX","endY","relativeX","relativeY","off","ELEMS_WITH_GRABBING_CURSOR","image","widthDiff","heightDiff","δ","width","height","stageWidth","stageHeight","position","hasClass","newLeft","newTop","extend","ELEMS_WITH_RESIZE_CURSOR","minWidth","minHeight","resizableHandleE","resizableHandleW","resizableHandleS","resizableHandleN","resizableHandleSE","resizableHandleSW","resizableHandleNE","resizableHandleNW","resizableHandles","append","modalData","imgWidth","imgHeight","direction","getModalOpts","dir","offsetX","offsetY","modalLeft","l","modalTop","t","opts","Math","max","getImageOpts","widthDiff2","heightDiff2","imgLeft","imgTop","imgLeft2","imgTop2","modalOpts","imageOpts","each","handle","PhotoViewer","items","DEFAULTS","isArray","footToolbar","headToolbar","$el","isOpened","rotateAngle","init","groupData","groupIndex","imgSrc","open","loadImg","draggable","$photoviewer","movable","$stage","$image","resizable","modalWidth","modalHeight","_creatBtns","toolbar","btns","btnsStr","index","item","_creatTitle","title","_creatDOM","btnsTpl","i18n","minimize","icons","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight","photoviewerHTML","build","$header","find","$headToolbar","$footer","$footToolbar","$title","$close","$maximize","$minimize","$zoomIn","$zoomOut","$actualSize","$fullscreen","$rotateLeft","$rotateRight","$prev","$next","eq","remove","fixedContent","_triggerHook","addEvents","setModalPos","zeroModal","winWidth","winHeight","scrollLeft","scrollTop","initMaximized","setModalSize","stageCSS","right","borderLeft","borderRight","bottom","borderTop","borderBottom","gapThreshold","min","scale","fixedModalSize","round","modalCSSObj","initAnimation","animate","setImageSize","ceil","fadeIn","loaderHTML","hide","fixedModalPos","setImgTitle","caption","captionTxt","html","jump","jumpTo","wheel","delta","deltaY","wheelDelta","detail","ratio","ratioThreshold","pointer","zoom","origin","originalWidth","minRatio","maxRatio","zoomTo","imgData","newWidth","newHeight","originalHeight","x","y","imgNewWidth","imgNewHeight","rotate","angle","rotateTo","resize","resizeHandler","keydown","keyboard","keyCode","which","charCode","ctrlKey","metaKey","altKey","data","callbacks","prototype","jqEl","getImgGroup","list","groupName","push","photoviewer","key","isNaN","stopPropagation","currentGroupName","groupList","undefined","not"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,eAAe;;aAGF,IAHE;;aAMF,IANE;;WASJ,IATI;;YAYH,IAZG;;SAeN,IAfM;;cAkBD,GAlBC;;eAqBA,GArBA;;gBAwBC,IAxBD;;kBA2BG,KA3BH;;iBA8BE,KA9BF;;gBAiCC,IAjCD;;kBAoCG,GApCH;;YAuCH,GAvCG;;YA0CH,EA1CG;;eA6CA,CACX,UADW,EAEX,OAFW,CA7CA;;eAmDA,CACX,QADW,EAEX,SAFW,EAGX,MAHW,EAIX,YAJW,EAKX,MALW,EAMX,YANW,EAOX,aAPW,CAnDA;;SA8DN;mIAAA;kJAAA;sOAAA;6aAAA;kZAAA;sJAAA;oJAAA;2OAAA;6WAAA;8hBAAA;;GA9DM;;QA4FP;cACM,UADN;cAEM,UAFN;WAGG,OAHH;YAII,YAJJ;aAKK,aALL;UAME,SANF;UAOE,SAPF;gBAQQ,YARR;gBASQ,yBATR;gBAUQ,qBAVR;iBAWS;GAvGF;;kBA2GG,IA3GH;;iBA8GE,IA9GF;;iBAiHE,KAjHF;;UAoHL,IApHK;;cAuHD,KAvHC;;aA0HF;gBACGA,EAAEC,IADL;YAEDD,EAAEC,IAFD;iBAGID,EAAEC,IAHN;YAIDD,EAAEC,IAJD;kBAKKD,EAAEC,IALP;aAMAD,EAAEC;GAhIA;;SAoIN;CApIT;;ACAA;;;;AAIA,AAAO,SAASC,SAAT,CAAmBC,EAAnB,EAAuB;;MAExBC,MAAMJ,EAAEG,EAAF,EAAME,IAAN,CAAW,UAAX,IAAyBL,EAAEG,EAAF,EAAME,IAAN,CAAW,UAAX,CAAzB,GAAkDL,EAAEG,EAAF,EAAME,IAAN,CAAW,MAAX,CAA5D;SACOD,GAAP;;;;;;;;;AASF,AAAO,SAASE,QAAT,CAAkBC,EAAlB,EAAsBC,KAAtB,EAA6B;MAE9BC,QAAQ,IAAZ;SAEO,YAAY;QACbC,UAAU,IAAd;QACEC,OAAOC,SADT;iBAGaH,KAAb;YAEQI,WAAW,YAAY;SAC1BC,KAAH,CAASJ,OAAT,EAAkBC,IAAlB;KADM,EAELH,KAFK,CAAR;GANF;;;;;;;;;AAmBF,AAAO,SAASO,UAAT,CAAoBX,GAApB,EAAyBY,OAAzB,EAAkCC,KAAlC,EAAyC;MAE1CC,MAAM,IAAIC,KAAJ,EAAV;;MAEIC,MAAJ,GAAa,YAAY;YACfF,GAAR;GADF;;MAIIG,OAAJ,GAAc,YAAY;UAClBH,GAAN;GADF;;MAIId,GAAJ,GAAUA,GAAV;;;;;;;AAQF,AAAO,SAASkB,iBAAT,CAA2BC,OAA3B,EAAoC;MACrCA,QAAQD,iBAAZ,EAA+B;YACrBA,iBAAR;GADF,MAEO,IAAIC,QAAQC,oBAAZ,EAAkC;YAC/BA,oBAAR;GADK,MAEA,IAAID,QAAQE,uBAAZ,EAAqC;YAClCA,uBAAR;GADK,MAEA,IAAIF,QAAQG,mBAAZ,EAAiC;YAC9BA,mBAAR;;;AAIJ,AAaA;;;;;;AAKA,AAAO,SAASC,mBAAT,CAA6BC,GAA7B,EAAkC;MACnCC,MAAM,mCAAV;MACEC,MAAMF,IAAIG,OAAJ,CAAYF,GAAZ,EAAiB,IAAjB,CADR;SAEOC,GAAP;;;;;;;;AAQF,AAAO,SAASE,kBAAT,CAA4BC,KAA5B,EAAmC;MACpCJ,MAAM,MAAV;MACEK,MAAMD,MAAME,KAAN,CAAYN,GAAZ,CADR;MAEEO,MAAMC,WAAWH,IAAI,CAAJ,CAAX,CAFR;SAGOE,GAAP;;;;;;;AAOF,AAAO,SAASE,YAAT,GAAwB;SACtBC,SAASC,IAAT,CAAcC,YAAd,IAA8BC,OAAOC,WAAP,IAAsBJ,SAASK,eAAT,CAAyBC,YAA7E,CAAP;;;;;;;AAOF,AAAO,SAASC,iBAAT,GAA6B;MAE9BC,YAAYR,SAASS,aAAT,CAAuB,KAAvB,CAAhB;YACUC,KAAV,CAAgBC,OAAhB,GAA0B,gFAA1B;WACSV,IAAT,CAAcW,WAAd,CAA0BJ,SAA1B;MACIK,iBAAiBL,UAAUM,WAAV,GAAwBN,UAAUO,WAAvD;WACSd,IAAT,CAAce,WAAd,CAA0BR,SAA1B;SAEOK,cAAP;;;;;;;;;;AAWF,AAAO,SAASI,aAAT,CAAuBC,SAAvB,EAAkCC,SAAlC,EAA6CC,KAA7C,EAAoDC,SAApD,EAA+D;MAEhEC,aAAa,CAACD,SAAD,GAAaH,UAAUK,CAAvB,GAA2BL,UAAUM,CAAtD;MACEC,cAAc,CAACJ,SAAD,GAAaH,UAAUM,CAAvB,GAA2BN,UAAUK,CADrD;;MAGIE,cAAcN,UAAUK,CAAxB,IAA6BF,aAAaH,UAAUI,CAAxD,EAA2D;UACnDG,QAAN,CAAe,SAAf;;;MAEED,eAAeN,UAAUK,CAAzB,IAA8BF,cAAcH,UAAUI,CAA1D,EAA6D;UACrDI,WAAN,CAAkB,SAAlB;;;;;;;;AAQJ,AAAO,SAASC,YAAT,GAAwB;SACtB,CAAC,EAAG,kBAAkBzB,MAAnB,IAA8BA,OAAO0B,aAAP,IAAwB7B,oBAAoB6B,aAA5E,CAAR;;;ACzJK,IAAMC,KAAKrE,EAAE0C,MAAF,CAAX;AACP,AAAO,IAAM4B,KAAKtE,EAAEuC,QAAF,CAAX;AAEP,AAAO,IAAMgC,cAAc,OAApB;AACP,AAAO,IAAMC,eAAe,QAArB;AACP,AAAO,IAAMC,gBAAgB,SAAtB;AACP,AAAO,IAAMC,cAAc,iCAApB;AAEP,AAAO,IAAMC,oBAAoBR,iBAAiB,YAAjB,GAAgC,WAA1D;AACP,AAAO,IAAMS,mBAAmBT,iBAAiB,WAAjB,GAA+B,WAAxD;AACP,AAAO,IAAMU,kBAAkBV,iBAAiB,UAAjB,GAA8B,SAAtD;AAEP,AAAO,IAAMW,KAAK,aAAX;AACP,AAAO,IAAMC,WAAW,MAAMD,EAAvB;AACP,AAAO,IAAME,WAAW,MAAMF,EAAvB;AAEP,AAAO,IAAMG,cAAc;;YAEf,KAFe;;cAIb,KAJa;;UAMjBC,SAASC;CANZ;;ACVP,gBAAe;;;;;;;WAAA,qBAQHC,KARG,EAQIC,UARJ,EAQgBC,UARhB,EAQ4B;QAEnCC,OAAO,IAAX;QAEIC,aAAa,KAAjB;QAEIC,SAAS,CAAb;QACEC,SAAS,CADX;QAGEC,OAAO,CAHT;QAIEC,MAAM,CAJR;;QAMIC,YAAY,SAAZA,SAAY,CAAUC,CAAV,EAAa;UAEvBA,KAAKpD,OAAOqD,KAAhB,CAF2B;;;UAOvBR,KAAKS,OAAL,CAAaC,cAAjB,EAAiC;cACzBC,GAAN,CAAU,SAAV,EAAqB,EAAEjB,YAAY,QAAZ,CAAvB;OARyB;;;UAYvBkB,aAAanG,EAAE8F,EAAEM,MAAJ,EAAYC,OAAZ,CAAoBf,UAApB,CAAjB,CAZ2B;;UAcvBa,WAAWG,MAAf,EAAuB;eACd,IAAP;;;mBAGW,IAAb;eAESR,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA3D,GAAmEZ,EAAEa,OAA9E;eACSb,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA3D,GAAmEd,EAAEe,OAA9E;aAEO7G,EAAEoF,KAAF,EAAS0B,MAAT,GAAkBnB,IAAzB;YACM3F,EAAEoF,KAAF,EAAS0B,MAAT,GAAkBlB,GAAxB;SAEGmB,EAAH,CAAMnC,mBAAmBI,QAAzB,EAAmCgC,QAAnC,EACGD,EADH,CACMlC,kBAAkBG,QADxB,EACkCiC,OADlC;KA1BF;;QA+BID,WAAW,SAAXA,QAAW,CAAUlB,CAAV,EAAa;UAEtBA,KAAKpD,OAAOqD,KAAhB;QAEEmB,cAAF;;UAEI1B,cAAc,CAACP,YAAY,UAAZ,CAAf,IAA0C,CAACA,YAAY,YAAZ,CAA3C,IAAwE,CAACM,KAAK4B,WAAlF,EAA+F;YAEzFC,OAAOtB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA1D,GAAkEZ,EAAEa,OAA/E;YACEU,OAAOvB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA1D,GAAkEd,EAAEe,OAD7E;YAGES,YAAYF,OAAO3B,MAHrB;YAIE8B,YAAYF,OAAO3B,MAJrB;UAMEN,KAAF,EAASc,GAAT,CAAa;gBACLoB,YAAY3B,IAAZ,GAAmB,IADd;eAEN4B,YAAY3B,GAAZ,GAAkB;SAFzB;;KAdJ;;QAuBIqB,UAAU,SAAVA,OAAU,GAAY;SAErBO,GAAH,CAAO5C,mBAAmBI,QAA1B,EAAoCgC,QAApC,EACGQ,GADH,CACO3C,kBAAkBG,QADzB,EACmCiC,OADnC;mBAGa,KAAb;KALF;;MASE5B,UAAF,EAAc0B,EAAd,CAAiBpC,oBAAoBK,QAArC,EAA+Ca,SAA/C;;CAnFJ;;ACCA,IAAM4B,6CAA2C3C,EAA3C,gBAAwDA,EAAxD,gBAAqEA,EAArE,iBAAmFA,EAAnF,sBAAN;AAEA,cAAe;;;;;;;;;;;;;SAAA,mBAcLnB,KAdK,EAcE+D,KAdF,EAcS;QAEhBnC,OAAO,IAAX;QAEIC,aAAa,KAAjB;QAEIC,SAAS,CAAb;QACEC,SAAS,CADX;QAGEC,OAAO,CAHT;QAIEC,MAAM,CAJR;QAME+B,YAAY,CANd;QAOEC,aAAa,CAPf;QASEC,IAAI,CATN;;QAWIhC,YAAY,SAAZA,SAAY,CAAUC,CAAV,EAAa;UAEvBA,KAAKpD,OAAOqD,KAAhB;QAEEmB,cAAF;UAEIrD,aAAa7D,EAAE0H,KAAF,EAASI,KAAT,EAAjB;UACE9D,cAAchE,EAAE0H,KAAF,EAASK,MAAT,EADhB;UAEEC,aAAahI,EAAE2D,KAAF,EAASmE,KAAT,EAFf;UAGEG,cAAcjI,EAAE2D,KAAF,EAASoE,MAAT,EAHhB;eAKSjC,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA3D,GAAmEZ,EAAEa,OAA9E;eACSb,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA3D,GAAmEd,EAAEe,OAA9E,CAZ2B;;UAevB,CAACtB,KAAK3B,SAAN,GAAkB,CAAlB,GAAsB,CAACC,aAAaG,WAAd,IAA6B,CAAvD,CAf2B;;kBAkBf,CAACuB,KAAK3B,SAAN,GAAmBC,aAAamE,UAAhC,GAA+ChE,cAAcgE,UAAzE;mBACa,CAACzC,KAAK3B,SAAN,GAAmBI,cAAciE,WAAjC,GAAiDpE,aAAaoE,WAA3E,CAnB2B;;mBAsBbN,YAAY,CAAZ,IAAiBC,aAAa,CAA/B,GAAoC,IAApC,GAA2C,KAAxD;kBACY,UAAZ,IAA2BD,YAAY,CAAZ,IAAiBC,aAAa,CAA/B,GAAoC,IAApC,GAA2C,KAArE,CAvB2B;;;aA2BpB5H,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAApB,GAA2BkC,CAAlC;YACM7H,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAApB,GAA0BiC,CAAhC,CA5B2B;;UA+BvBlE,MAAMwE,QAAN,CAAe,SAAf,CAAJ,EAA+B;UAC3BV,0BAAF,EAA8BxD,QAA9B,CAAuC,aAAvC;;;SAGC8C,EAAH,CAAMnC,mBAAmBI,QAAzB,EAAmCgC,QAAnC,EACGD,EADH,CACMlC,kBAAkBG,QADxB,EACkCiC,OADlC;KAnCF;;QAwCID,WAAW,SAAXA,QAAW,CAAUlB,CAAV,EAAa;UAEtBA,KAAKpD,OAAOqD,KAAhB;QAEEmB,cAAF;;UAEI1B,UAAJ,EAAgB;YAEV4B,OAAOtB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA1D,GAAkEZ,EAAEa,OAA/E;YACEU,OAAOvB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA1D,GAAkEd,EAAEe,OAD7E;YAGES,YAAYF,OAAO3B,MAHrB;YAIE8B,YAAYF,OAAO3B,MAJrB;YAME0C,UAAUd,YAAY3B,IANxB;YAOE0C,SAASd,YAAY3B,GAPvB,CAFc;;YAYVgC,aAAa,CAAjB,EAAoB;cAEbL,YAAY3B,GAAb,GAAoBiC,CAAxB,EAA2B;qBAChBA,CAAT;WADF,MAEO,IAAKN,YAAY3B,GAAb,GAAoB,CAACgC,UAAD,GAAcC,CAAtC,EAAyC;qBACrC,CAACD,UAAD,GAAcC,CAAvB;;SALJ,MAQO;mBACIjC,GAAT;SArBY;;;YAwBV+B,YAAY,CAAhB,EAAmB;cAEZL,YAAY3B,IAAb,GAAqB,CAACkC,CAA1B,EAA6B;sBACjB,CAACA,CAAX;WADF,MAEO,IAAKP,YAAY3B,IAAb,GAAqB,CAACgC,SAAD,GAAaE,CAAtC,EAAyC;sBACpC,CAACF,SAAD,GAAaE,CAAvB;;SALJ,MAQO;oBACKlC,IAAV;;;UAGA+B,KAAF,EAASxB,GAAT,CAAa;gBACLkC,UAAU,IADL;eAENC,SAAS;SAFhB,EApCc;;UA0CZC,MAAF,CAAS/C,KAAK9B,SAAd,EAAyB;gBACjB2E,OADiB;eAElBC;SAFP;;KAhDJ;;QAyDIpB,UAAU,SAAVA,OAAU,GAAY;SAErBO,GAAH,CAAO5C,mBAAmBI,QAA1B,EAAoCgC,QAApC,EACGQ,GADH,CACO3C,kBAAkBG,QADzB,EACmCiC,OADnC;mBAGa,KAAb;kBACY,UAAZ,IAA0B,KAA1B,CANwB;;QAStBQ,0BAAF,EAA8BvD,WAA9B,CAA0C,aAA1C;KATF;;MAaEP,KAAF,EAASoD,EAAT,CAAYpC,oBAAoBK,QAAhC,EAA0Ca,SAA1C;;CA7IJ;;ACEA,IAAM0C,2CAAyCzD,EAAzC,gBAAsDA,EAAtD,gBAAmEA,EAAnE,YAAN;AAEA,gBAAe;;;;;;;;;;;;;;;WAAA,qBAgBHM,KAhBG,EAgBIzB,KAhBJ,EAgBW+D,KAhBX,EAgBkBc,QAhBlB,EAgB4BC,SAhB5B,EAgBuC;QAE9ClD,OAAO,IAAX;QAEImD,mBAAmB1I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,kCAAvB;QACE6D,mBAAmB3I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,kCADrB;QAEE8D,mBAAmB5I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,kCAFrB;QAGE+D,mBAAmB7I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,kCAHrB;QAIEgE,oBAAoB9I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,mCAJtB;QAKEiE,oBAAoB/I,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,mCALtB;QAMEkE,oBAAoBhJ,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,mCANtB;QAOEmE,oBAAoBjJ,oBAAiB8E,EAAjB,0BAAwCA,EAAxC,mCAPtB;QASIoE,mBAAmB;WAChBR,gBADgB;WAEhBE,gBAFgB;YAGfE,iBAHe;WAIhBD,gBAJgB;WAKhBF,gBALgB;YAMfM,iBANe;YAOfD,iBAPe;YAQfD;KARR;MAWE3D,KAAF,EAAS+D,MAAT,CACET,gBADF,EACoBC,gBADpB,EACsCC,gBADtC,EACwDC,gBADxD,EAEEC,iBAFF,EAEqBC,iBAFrB,EAEwCC,iBAFxC,EAE2DC,iBAF3D;QAKIzD,aAAa,KAAjB;QAEIC,SAAS,CAAb;QACEC,SAAS,CADX;QAGE0D,YAAY;SACP,CADO;SAEP,CAFO;SAGP,CAHO;SAIP;KAPP;QASE1F,YAAY;SACP,CADO;SAEP,CAFO;SAGP,CAHO;SAIP;KAbP;QAeED,YAAY;SACP,CADO;SAEP,CAFO;SAGP,CAHO;SAIP;KAnBP;;QAuBM,CAvBN;QAwBE4F,WAAW,CAxBb;QAyBEC,YAAY,CAzBd;QA2BEC,YAAY,EA3Bd,CA/BkD;;QA6D9CC,eAAe,SAAfA,YAAe,CAAUC,GAAV,EAAeC,OAAf,EAAwBC,OAAxB,EAAiC;;UAG9CC,YAAa,CAACF,OAAD,GAAWN,UAAUtF,CAAtB,GAA2B0E,QAA3B,GAAuCkB,UAAUN,UAAUS,CAA3D,GAAiET,UAAUS,CAAV,GAAcT,UAAUtF,CAAxB,GAA4B0E,QAA7G;UACEsB,WAAY,CAACH,OAAD,GAAWP,UAAUrF,CAAtB,GAA2B0E,SAA3B,GAAwCkB,UAAUP,UAAUW,CAA5D,GAAkEX,UAAUW,CAAV,GAAcX,UAAUrF,CAAxB,GAA4B0E,SAD3G;UAGIuB,OAAO;aACJ;iBACIC,KAAKC,GAAL,CAAUR,UAAUN,UAAUtF,CAA9B,EAAkC0E,QAAlC,IAA8C;SAF9C;aAIJ;kBACKyB,KAAKC,GAAL,CAAUP,UAAUP,UAAUrF,CAA9B,EAAkC0E,SAAlC,IAA+C;SALhD;cAOH;iBACGwB,KAAKC,GAAL,CAAUR,UAAUN,UAAUtF,CAA9B,EAAkC0E,QAAlC,IAA8C,IADjD;kBAEIyB,KAAKC,GAAL,CAAUP,UAAUP,UAAUrF,CAA9B,EAAkC0E,SAAlC,IAA+C;SAThD;aAWJ;iBACIwB,KAAKC,GAAL,CAAU,CAACR,OAAD,GAAWN,UAAUtF,CAA/B,EAAmC0E,QAAnC,IAA+C,IADnD;gBAEGoB,YAAY;SAbX;aAeJ;kBACKK,KAAKC,GAAL,CAAU,CAACP,OAAD,GAAWP,UAAUrF,CAA/B,EAAmC0E,SAAnC,IAAgD,IADrD;eAEEqB,WAAW;SAjBT;cAmBH;iBACGG,KAAKC,GAAL,CAAU,CAACR,OAAD,GAAWN,UAAUtF,CAA/B,EAAmC0E,QAAnC,IAA+C,IADlD;kBAEIyB,KAAKC,GAAL,CAAU,CAACP,OAAD,GAAWP,UAAUrF,CAA/B,EAAmC0E,SAAnC,IAAgD,IAFpD;eAGCqB,WAAW,IAHZ;gBAIEF,YAAY;SAvBX;cAyBH;iBACGK,KAAKC,GAAL,CAAUR,UAAUN,UAAUtF,CAA9B,EAAkC0E,QAAlC,IAA8C,IADjD;kBAEIyB,KAAKC,GAAL,CAAU,CAACP,OAAD,GAAWP,UAAUrF,CAA/B,EAAmC0E,SAAnC,IAAgD,IAFpD;eAGCqB,WAAW;SA5BT;cA8BH;iBACGG,KAAKC,GAAL,CAAU,CAACR,OAAD,GAAWN,UAAUtF,CAA/B,EAAmC0E,QAAnC,IAA+C,IADlD;kBAEIyB,KAAKC,GAAL,CAAUP,UAAUP,UAAUrF,CAA9B,EAAkC0E,SAAlC,IAA+C,IAFnD;gBAGEmB,YAAY;;OAjCtB;aAqCOI,KAAKP,GAAL,CAAP;KA3CF,CA7DkD;;;QA4G9CU,eAAe,SAAfA,YAAe,CAAUV,GAAV,EAAeC,OAAf,EAAwBC,OAAxB,EAAiC;;;UAI9ChC,YAAa+B,UAAUN,UAAUtF,CAArB,GAA0B0E,QAA1B,GAAsC9E,UAAUI,CAAV,GAAcuF,QAAd,GAAyBK,OAAzB,GAAmC7B,CAAzE,GAA+EW,YAAYY,UAAUtF,CAAV,GAAcJ,UAAUI,CAApC,IAAyCuF,QAAzC,GAAoDxB,CAAnJ;UACED,aAAc+B,UAAUP,UAAUrF,CAArB,GAA0B0E,SAA1B,GAAuC/E,UAAUK,CAAV,GAAcuF,SAAd,GAA0BK,OAA1B,GAAoC9B,CAA3E,GAAiFY,aAAaW,UAAUrF,CAAV,GAAcL,UAAUK,CAArC,IAA0CuF,SAA1C,GAAsDzB,CADtJ;UAGEuC,aAAc,CAACV,OAAD,GAAWN,UAAUtF,CAAtB,GAA2B0E,QAA3B,GAAuC9E,UAAUI,CAAV,GAAcuF,QAAd,GAAyBK,OAAzB,GAAmC7B,CAA1E,GAAgFW,YAAYY,UAAUtF,CAAV,GAAcJ,UAAUI,CAApC,IAAyCuF,QAAzC,GAAoDxB,CAHnJ;UAIEwC,cAAe,CAACV,OAAD,GAAWP,UAAUrF,CAAtB,GAA2B0E,SAA3B,GAAwC/E,UAAUK,CAAV,GAAcuF,SAAd,GAA0BK,OAA1B,GAAoC9B,CAA5E,GAAkFY,aAAaW,UAAUrF,CAAV,GAAcL,UAAUK,CAArC,IAA0CuF,SAA1C,GAAsDzB,CAJxJ,CAJkD;;UAW9CyC,UAAU,CAAC3C,YAAY,CAAZ,GAAgB3H,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAApC,GAA4C3F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAApB,GAA2B,CAA3B,GAA+B3F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAAnD,GAA0D,CAAvG,IAA6GkC,CAA3H;UACE0C,SAAS,CAAC3C,aAAa,CAAb,GAAiB5H,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAArC,GAA4C5F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAApB,GAA0B,CAA1B,GAA8B5F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAAlD,GAAwD,CAArG,IAA2GiC,CADtH;UAGE2C,WAAW,CAACJ,aAAa,CAAb,GAAiBpK,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAArC,GAA6C3F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAApB,GAA2B,CAA3B,GAA+B3F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAAnD,GAA0D,CAAxG,IAA8GkC,CAH3H;UAIE4C,UAAU,CAACJ,cAAc,CAAd,GAAkBrK,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAAtC,GAA6C5F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAApB,GAA0B,CAA1B,GAA8B5F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC,GAAlD,GAAwD,CAAtG,IAA4GiC,CAJxH;UAMImC,OAAO;aACJ;gBACGrC,aAAa,CAACE,CAAd,GAAmB,CAACF,YAAYE,CAAb,IAAkB,CAAlB,GAAsB,IAAzC,GAAkDyC,UAAU3C,SAAV,GAAuB2C,UAAU,IAAjC,GAA0C3C,YAAY;SAFvG;aAIJ;eACEC,cAAcC,CAAd,GAAmB,CAACD,aAAaC,CAAd,IAAmB,CAAnB,GAAuB,IAA1C,GAAmD0C,SAAS3C,UAAT,GAAuB2C,SAAS,IAAhC,GAAyC3C,aAAa;SALvG;cAOH;eACCA,cAAcC,CAAd,GAAmB,CAACD,aAAaC,CAAd,IAAmB,CAAnB,GAAuB,IAA1C,GAAmD0C,SAAS3C,UAAT,GAAuB2C,SAAS,IAAhC,GAAyC3C,aAAa,IAD1G;gBAEED,aAAa,CAACE,CAAd,GAAmB,CAACF,YAAYE,CAAb,IAAkB,CAAlB,GAAsB,IAAzC,GAAkDyC,UAAU3C,SAAV,GAAuB2C,UAAU,IAAjC,GAA0C3C,YAAY;SATvG;aAWJ;gBACGyC,cAAc,CAACvC,CAAf,GAAoB,CAACuC,aAAavC,CAAd,IAAmB,CAAnB,GAAuB,IAA3C,GAAoD2C,WAAWJ,UAAX,GAAyBI,WAAW,IAApC,GAA6CJ,aAAa;SAZ7G;aAcJ;eACEC,eAAexC,CAAf,GAAoB,CAACwC,cAAcxC,CAAf,IAAoB,CAApB,GAAwB,IAA5C,GAAqD4C,UAAUJ,WAAV,GAAyBI,UAAU,IAAnC,GAA4CJ,cAAc;SAf7G;cAiBH;eACCA,eAAexC,CAAf,GAAoB,CAACwC,cAAcxC,CAAf,IAAoB,CAApB,GAAwB,IAA5C,GAAqD4C,UAAUJ,WAAV,GAAyBI,UAAU,IAAnC,GAA4CJ,cAAc,IADhH;gBAEED,cAAc,CAACvC,CAAf,GAAoB,CAACuC,aAAavC,CAAd,IAAmB,CAAnB,GAAuB,IAA3C,GAAoD2C,WAAWJ,UAAX,GAAyBI,WAAW,IAApC,GAA6CJ,aAAa;SAnB7G;cAqBH;eACCC,eAAexC,CAAf,GAAoB,CAACwC,cAAcxC,CAAf,IAAoB,CAApB,GAAwB,IAA5C,GAAqD4C,UAAUJ,WAAV,GAAyBI,UAAU,IAAnC,GAA4CJ,cAAc,IADhH;gBAEE1C,aAAa,CAACE,CAAd,GAAmB,CAACF,YAAYE,CAAb,IAAkB,CAAlB,GAAsB,IAAzC,GAAkDyC,UAAU3C,SAAV,GAAuB2C,UAAU,IAAjC,GAA0C3C,YAAY;SAvBvG;cAyBH;eACCC,cAAcC,CAAd,GAAmB,CAACD,aAAaC,CAAd,IAAmB,CAAnB,GAAuB,IAA1C,GAAmD0C,SAAS3C,UAAT,GAAuB2C,SAAS,IAAhC,GAAyC3C,aAAa,IAD1G;gBAEEwC,cAAc,CAACvC,CAAf,GAAoB,CAACuC,aAAavC,CAAd,IAAmB,CAAnB,GAAuB,IAA3C,GAAoD2C,WAAWJ,UAAX,GAAyBI,WAAW,IAApC,GAA6CJ,aAAa;;OA3BxH;aA+BOJ,KAAKP,GAAL,CAAP;KAhDF;;QAmDI5D,YAAY,SAAZA,SAAY,CAAU4D,GAAV,EAAe3D,CAAf,EAAkB;UAE5BA,KAAKpD,OAAOqD,KAAhB;QAEEmB,cAAF;mBAEa,IAAb;kBACY,YAAZ,IAA4B,IAA5B;eAESpB,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA3D,GAAmEZ,EAAEa,OAA9E;eACSb,EAAES,IAAF,KAAW,YAAX,GAA0BT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA3D,GAAmEd,EAAEe,OAA9E,CAVgC;;kBAapB;WACP7G,EAAEoF,KAAF,EAAS0C,KAAT,EADO;WAEP9H,EAAEoF,KAAF,EAAS2C,MAAT,EAFO;WAGP/H,EAAEoF,KAAF,EAAS0B,MAAT,GAAkBnB,IAHX;WAIP3F,EAAEoF,KAAF,EAAS0B,MAAT,GAAkBlB;OAJvB;kBAOY;WACP5F,EAAE2D,KAAF,EAASmE,KAAT,EADO;WAEP9H,EAAE2D,KAAF,EAASoE,MAAT,EAFO;WAGP/H,EAAE2D,KAAF,EAASmD,MAAT,GAAkBnB,IAHX;WAIP3F,EAAE2D,KAAF,EAASmD,MAAT,GAAkBlB;OAJvB;kBAOY;WACP5F,EAAE0H,KAAF,EAASI,KAAT,EADO;WAEP9H,EAAE0H,KAAF,EAASK,MAAT,EAFO;WAGP/H,EAAE0H,KAAF,EAASQ,QAAT,GAAoBvC,IAHb;WAIP3F,EAAE0H,KAAF,EAASQ,QAAT,GAAoBtC;OAJzB,CA3BgC;;UAmC5B,CAACL,KAAK3B,SAAN,GAAkB,CAAlB,GAAsB,CAACH,UAAUK,CAAV,GAAcL,UAAUM,CAAzB,IAA8B,CAAxD;iBACW,CAACwB,KAAK3B,SAAN,GAAkBH,UAAUK,CAA5B,GAAgCL,UAAUM,CAArD;kBACY,CAACwB,KAAK3B,SAAN,GAAkBH,UAAUM,CAA5B,GAAgCN,UAAUK,CAAtD;kBAEY2F,GAAZ,CAvCgC;;QA0C9BlB,wBAAF,EAA4BrC,GAA5B,CAAgC,QAAhC,EAA0CuD,MAAM,SAAhD;SAEG1C,EAAH,CAAMnC,mBAAmBI,QAAzB,EAAmCgC,QAAnC,EACGD,EADH,CACMlC,kBAAkBG,QADxB,EACkCiC,OADlC;KA5CF;;QAiDID,WAAW,SAAXA,QAAW,CAAUlB,CAAV,EAAa;UAEtBA,KAAKpD,OAAOqD,KAAhB;QAEEmB,cAAF;;UAEI1B,cAAc,CAACD,KAAK4B,WAAxB,EAAqC;YAE/BC,OAAOtB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCC,KAA1D,GAAkEZ,EAAEa,OAA/E;YACEU,OAAOvB,EAAES,IAAF,KAAW,WAAX,GAAyBT,EAAEU,aAAF,CAAgBC,aAAhB,CAA8B,CAA9B,EAAiCG,KAA1D,GAAkEd,EAAEe,OAD7E;YAGES,YAAYF,OAAO3B,MAHrB;YAIE8B,YAAYF,OAAO3B,MAJrB;YAMIgF,YAAYlB,aAAaD,SAAb,EAAwBjC,SAAxB,EAAmCC,SAAnC,CAAhB;UAEEnC,KAAF,EAASc,GAAT,CAAawE,SAAb;YAEIC,YAAYR,aAAaZ,SAAb,EAAwBjC,SAAxB,EAAmCC,SAAnC,CAAhB;UAEEG,KAAF,EAASxB,GAAT,CAAayE,SAAb;;KApBJ;;QA0BI1D,UAAU,SAAVA,OAAU,GAAY;SAErBO,GAAH,CAAO5C,mBAAmBI,QAA1B,EAAoCgC,QAApC,EACGQ,GADH,CACO3C,kBAAkBG,QADzB,EACmCiC,OADnC,EAFwB;;UAMpBhC,YAAY,YAAZ,CAAJ,EAA+B;sBACf;aAAKoE,QAAL;aAAkBC;SAAhC,EAA6C;aAAKtJ,EAAE2D,KAAF,EAASmE,KAAT,EAAL;aAA0B9H,EAAE2D,KAAF,EAASoE,MAAT;SAAvE,EACEpE,KADF;;;mBAKW,KAAb;kBACY,YAAZ,IAA4B,KAA5B,CAbwB;;QAgBtB4E,wBAAF,EAA4BrC,GAA5B,CAAgC,QAAhC,EAA0C,EAA1C;KAhBF;;MAoBE0E,IAAF,CAAO1B,gBAAP,EAAyB,UAAUO,GAAV,EAAeoB,MAAf,EAAuB;aACvC9D,EAAP,CAAUpC,oBAAoBK,QAA9B,EAAwC,UAAUc,CAAV,EAAa;kBACzC2D,GAAV,EAAe3D,CAAf;OADF;KADF;;CA9QJ;;ACiBA;;;;IAGMgF;;;uBAEQC,KAAZ,EAAmB/E,OAAnB,EAA4B7F,EAA5B,EAAgC;QAE1BoF,OAAO,IAAX;SAEKS,OAAL,GAAehG,IAAEsI,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB0C,QAAnB,EAA6BhF,OAA7B,CAAf;;QAEIA,WAAWhG,IAAEiL,OAAF,CAAUjF,QAAQkF,WAAlB,CAAf,EAA+C;WACxClF,OAAL,CAAakF,WAAb,GAA2BlF,QAAQkF,WAAnC;;;QAGElF,WAAWhG,IAAEiL,OAAF,CAAUjF,QAAQmF,WAAlB,CAAf,EAA+C;WACxCnF,OAAL,CAAamF,WAAb,GAA2BnF,QAAQmF,WAAnC;KAX4B;;;SAezBC,GAAL,GAAWpL,IAAEG,EAAF,CAAX,CAf8B;;;;SAqBzBkL,QAAL,GAAgB,KAAhB,CArB8B;;SAuBzBlE,WAAL,GAAmB,KAAnB,CAvB8B;;SAyBzBvD,SAAL,GAAiB,KAAjB,CAzB8B;;SA2BzB0H,WAAL,GAAmB,CAAnB,CA3B8B;;SA8BzB7H,SAAL,GAAiB,EAAjB,CA9B8B;;SAgCzB2F,SAAL,GAAiB;aACR,IADQ;cAEP,IAFO;YAGT,IAHS;WAIV;KAJP;SAOKmC,IAAL,CAAUR,KAAV,EAAiBxF,KAAKS,OAAtB,EAA+B7F,EAA/B;;;;;SAIFoL,qBAAKR,OAAOf,MAAM7J,IAAI;SAEfqL,SAAL,GAAiBT,KAAjB;SACKU,UAAL,GAAkBzB,KAAK,OAAL,CAAlB,CAHoB;;QAMhB0B,SAASX,MAAM,KAAKU,UAAX,EAAuB,KAAvB,CAAb;SAEKE,IAAL;SAEKC,OAAL,CAAaF,MAAb,EAVoB;;QAahB1B,KAAK6B,SAAT,EAAoB;WACbA,SAAL,CAAe,KAAKC,YAApB,EAAkC,KAAKzG,UAAvC,EAAmDN,WAAW,SAA9D;;;QAEEiF,KAAK+B,OAAT,EAAkB;WACXA,OAAL,CAAa,KAAKC,MAAlB,EAA0B,KAAKC,MAA/B;;;QAEEjC,KAAKkC,SAAT,EAAoB;WACbA,SAAL,CAAe,KAAKJ,YAApB,EAAkC,KAAKE,MAAvC,EAA+C,KAAKC,MAApD,EAA4DjC,KAAKmC,UAAjE,EAA6EnC,KAAKoC,WAAlF;;;;SAKJC,iCAAWC,SAASC,MAAM;QAEpBC,UAAU,EAAd;QAEE5B,IAAF,CAAO0B,OAAP,EAAgB,UAAUG,KAAV,EAAiBC,IAAjB,EAAuB;iBAC1BH,KAAKG,IAAL,CAAX;KADF;WAIOF,OAAP;;;SAIFG,qCAAc;WACJ,KAAK3G,OAAL,CAAa4G,KAAb,qBAAoC9H,EAApC,uBAAyD,EAAjE;;;SAGF+H,iCAAY;QAENC,UAAU;qCACgBhI,EAA5B,gBAAyCA,EAAzC,mCAAuE,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBC,QAAzF,iCACgB,KAAKhH,OAAL,CAAaiH,KAAb,CAAmBD,QADnC,kCADY;qCAIgBlI,EAA5B,gBAAyCA,EAAzC,mCAAuE,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBG,QAAzF,iCACgB,KAAKlH,OAAL,CAAaiH,KAAb,CAAmBC,QADnC,kCAJY;kCAOapI,EAAzB,gBAAsCA,EAAtC,gCAAiE,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBI,KAAnF,6BACY,KAAKnH,OAAL,CAAaiH,KAAb,CAAmBE,KAD/B,8BAPY;mCAUcrI,EAA1B,gBAAuCA,EAAvC,kCAAoE,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBK,MAAtF,+BACc,KAAKpH,OAAL,CAAaiH,KAAb,CAAmBG,MADjC,gCAVY;oCAaetI,EAA3B,gBAAwCA,EAAxC,mCAAsE,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBM,OAAxF,+BACc,KAAKrH,OAAL,CAAaiH,KAAb,CAAmBI,OADjC,gCAbY;iCAgBYvI,EAAxB,gBAAqCA,EAArC,+BAA+D,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBO,IAAjF,6BACY,KAAKtH,OAAL,CAAaiH,KAAb,CAAmBK,IAD/B,8BAhBY;iCAmBYxI,EAAxB,gBAAqCA,EAArC,+BAA+D,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBQ,IAAjF,6BACY,KAAKvH,OAAL,CAAaiH,KAAb,CAAmBM,IAD/B,8BAnBY;uCAsBkBzI,EAA9B,gBAA2CA,EAA3C,qCAA2E,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBS,UAA7F,iCACgB,KAAKxH,OAAL,CAAaiH,KAAb,CAAmBO,UADnC,kCAtBY;uCAyBkB1I,EAA9B,gBAA2CA,EAA3C,sCAA4E,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBU,UAA9F,mCACkB,KAAKzH,OAAL,CAAaiH,KAAb,CAAmBQ,UADrC,oCAzBY;uCA4BkB3I,EAA9B,gBAA2CA,EAA3C,sCAA4E,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBW,UAA9F,mCACkB,KAAK1H,OAAL,CAAaiH,KAAb,CAAmBS,UADrC,oCA5BY;wCA+BmB5I,EAA/B,gBAA4CA,EAA5C,uCAA8E,KAAKkB,OAAL,CAAa+G,IAAb,CAAkBY,WAAhG,mCACkB,KAAK3H,OAAL,CAAaiH,KAAb,CAAmBU,WADrC;KA/BF,CAFU;;QAuCNC,oCAAiC9I,EAAjC,4DACkCA,EADlC,8DAEoCA,EAFpC,iEAGsCA,EAHtC,iBAGoDA,EAHpD,4DAI4B,KAAKuH,UAAL,CAAgB,KAAKrG,OAAL,CAAamF,WAA7B,EAA0C2B,OAA1C,CAJ5B,kFAM0B,KAAKH,WAAL,EAN1B,2FAQoC7H,EARpC,gEASsCA,EATtC,wHAWoCA,EAXpC,iEAYsCA,EAZtC,iBAYoDA,EAZpD,4DAa4B,KAAKuH,UAAL,CAAgB,KAAKrG,OAAL,CAAakF,WAA7B,EAA0C4B,OAA1C,CAb5B,yJAAJ;WAmBOc,eAAP;;;SAIFC,yBAAQ;;QAGFD,kBAAkB,KAAKf,SAAL,EAAtB,CAHM;;;QAMFf,eAAe9L,IAAE4N,eAAF,CAAnB,CANM;;SASD9B,YAAL,GAAoBA,YAApB;SACKgC,OAAL,GAAehC,aAAaiC,IAAb,CAAkBhJ,WAAW,SAA7B,CAAf;SACKiJ,YAAL,GAAoBlC,aAAaiC,IAAb,CAAkBhJ,WAAW,eAA7B,CAApB;SACKkJ,OAAL,GAAenC,aAAaiC,IAAb,CAAkBhJ,WAAW,SAA7B,CAAf;SACKmJ,YAAL,GAAoBpC,aAAaiC,IAAb,CAAkBhJ,WAAW,eAA7B,CAApB;SACKiH,MAAL,GAAcF,aAAaiC,IAAb,CAAkBhJ,WAAW,QAA7B,CAAd;SACKoJ,MAAL,GAAcrC,aAAaiC,IAAb,CAAkBhJ,WAAW,QAA7B,CAAd;SACKkH,MAAL,GAAcH,aAAaiC,IAAb,CAAkBhJ,WAAW,QAA7B,CAAd;SACKqJ,MAAL,GAActC,aAAaiC,IAAb,CAAkBhJ,WAAW,eAA7B,CAAd;SACKsJ,SAAL,GAAiBvC,aAAaiC,IAAb,CAAkBhJ,WAAW,kBAA7B,CAAjB;SACKuJ,SAAL,GAAiBxC,aAAaiC,IAAb,CAAkBhJ,WAAW,kBAA7B,CAAjB;SACKwJ,OAAL,GAAezC,aAAaiC,IAAb,CAAkBhJ,WAAW,iBAA7B,CAAf;SACKyJ,QAAL,GAAgB1C,aAAaiC,IAAb,CAAkBhJ,WAAW,kBAA7B,CAAhB;SACK0J,WAAL,GAAmB3C,aAAaiC,IAAb,CAAkBhJ,WAAW,qBAA7B,CAAnB;SACK2J,WAAL,GAAmB5C,aAAaiC,IAAb,CAAkBhJ,WAAW,oBAA7B,CAAnB;SACK4J,WAAL,GAAmB7C,aAAaiC,IAAb,CAAkBhJ,WAAW,qBAA7B,CAAnB;SACK6J,YAAL,GAAoB9C,aAAaiC,IAAb,CAAkBhJ,WAAW,sBAA7B,CAApB;SACK8J,KAAL,GAAa/C,aAAaiC,IAAb,CAAkBhJ,WAAW,cAA7B,CAAb;SACK+J,KAAL,GAAahD,aAAaiC,IAAb,CAAkBhJ,WAAW,cAA7B,CAAb,CA3BM;;SA8BDiH,MAAL,CAAY/H,QAAZ,CAAqB,aAArB;SACKgI,MAAL,CAAYhI,QAAZ,CAAqB,aAArB,EA/BM;;SAkCD6H,YAAL,CAAkB5F,GAAlB,CAAsB,SAAtB,EAAiCjB,YAAY,QAAZ,CAAjC,EAlCM;;QAqCF,CAAC,KAAKe,OAAL,CAAaX,UAAd,IAA4B,KAAKW,OAAL,CAAaX,UAAb,KAA4BN,WAAW,QAAvE,EAAiF;WAC1EM,UAAL,GAAkB,KAAKyG,YAAvB;KADF,MAEO;WACAzG,UAAL,GAAkB,KAAKyG,YAAL,CAAkBiC,IAAlB,CAAuB,KAAK/H,OAAL,CAAaX,UAApC,CAAlB;;;;SAKJsG,uBAAO;QAED,CAAC,KAAK3F,OAAL,CAAaC,cAAlB,EAAkC;UAC9BlB,WAAW,QAAb,EAAuBgK,EAAvB,CAA0B,CAA1B,EAA6BC,MAA7B;KAHG;;;QAOD,CAAChP,IAAE+E,WAAW,QAAb,EAAuBuB,MAAxB,IAAkC,KAAKN,OAAL,CAAaiJ,YAAnD,EAAiE;UAE7D,MAAF,EAAU/I,GAAV,CAAc;oBAAc;OAA5B;;UAEI5D,cAAJ,EAAoB;YACdc,iBAAiBN,mBAArB;;YACIM,cAAJ,EAAoB;cAChB,MAAF,EAAU8C,GAAV,CAAc;6BAAmB9C;WAAjC;;;;;SAMDyK,KAAL;;SAEKqB,YAAL,CAAkB,YAAlB,EAAgC,KAAK9D,GAArC,EAtBK;;;QAyBH,MAAF,EAAUjC,MAAV,CAAiB,KAAK2C,YAAtB;SAEKqD,SAAL;SAEKC,WAAL,CAAiB,KAAKtD,YAAtB;;SAEKoD,YAAL,CAAkB,QAAlB,EAA4B,KAAK9D,GAAjC;;;SAIF+B,yBAAQ;SAED+B,YAAL,CAAkB,aAAlB,EAAiC,KAAK9D,GAAtC,EAFM;;;SAKDU,YAAL,CAAkBkD,MAAlB;SAEK3D,QAAL,GAAgB,KAAhB;SACKlE,WAAL,GAAmB,KAAnB;SACKvD,SAAL,GAAiB,KAAjB;SACK0H,WAAL,GAAmB,CAAnB;QAEI+D,YAAY,CAACrP,IAAE+E,WAAW,QAAb,EAAuBuB,MAAxC,CAZM;;QAeF+I,aAAa,KAAKrJ,OAAL,CAAaiJ,YAA9B,EAA4C;UACxC,MAAF,EAAU/I,GAAV,CAAc;oBAAc,EAAd;yBAAmC;OAAjD;KAhBI;;;QAoBFmJ,aAAa,KAAKrJ,OAAL,CAAaC,cAA9B,EAA8C;kBAChC,QAAZ,IAAwB,KAAKD,OAAL,CAAab,MAArC;KArBI;;;QAyBF,CAACnF,IAAE+E,WAAW,QAAb,EAAuBuB,MAA5B,EAAoC;SAC/BkB,GAAH,CAAO/C,gBAAgBO,QAAvB;SACGwC,GAAH,CAAOhD,eAAeQ,QAAtB;;;SAGGkK,YAAL,CAAkB,QAAlB,EAA4B,KAAK9D,GAAjC;;;SAIFgE,mCAAYhK,OAAO;QAEbkK,WAAWjL,GAAGyD,KAAH,EAAf;QACEyH,YAAYlL,GAAG0D,MAAH,EADd;QAEEyH,aAAalL,GAAGkL,UAAH,EAFf;QAGEC,YAAYnL,GAAGmL,SAAH,EAHd;QAKItD,aAAa,KAAKnG,OAAL,CAAamG,UAA9B;QACEC,cAAc,KAAKpG,OAAL,CAAaoG,WAD7B,CAPiB;;QAWb,KAAKpG,OAAL,CAAa0J,aAAjB,EAAgC;YAExBzL,QAAN,CAAea,KAAK,WAApB;YAEMoB,GAAN,CAAU;eACD,MADC;gBAEA,MAFA;cAGF,CAHE;aAIH;OAJP;WAOKmF,QAAL,GAAgB,IAAhB;WACKlE,WAAL,GAAmB,IAAnB;KAZF,MAcO;;YAGCjB,GAAN,CAAU;eACDiG,UADC;gBAEAC,WAFA;cAGF,CAACkD,WAAWnD,UAAZ,IAA0B,CAA1B,GAA8BqD,UAA9B,GAA2C,IAHzC;aAIH,CAACD,YAAYnD,WAAb,IAA4B,CAA5B,GAAgCqD,SAAhC,GAA4C;OAJnD;;;;SAWJE,qCAAazO,KAAK;QAEZqE,OAAO,IAAX;QACE+J,WAAWjL,GAAGyD,KAAH,EADb;QAEEyH,YAAYlL,GAAG0D,MAAH,EAFd;QAGEyH,aAAalL,GAAGkL,UAAH,EAHf;QAIEC,YAAYnL,GAAGmL,SAAH,EAJd,CAFgB;;QASZG,WAAW;YACP,KAAK5D,MAAL,CAAY9F,GAAZ,CAAgB,MAAhB,CADO;aAEN,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,OAAhB,CAFM;WAGR,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,KAAhB,CAHQ;cAIL,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,QAAhB,CAJK;kBAKD,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,mBAAhB,CALC;mBAMA,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,oBAAhB,CANA;iBAOF,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,kBAAhB,CAPE;oBAQC,KAAK8F,MAAL,CAAY9F,GAAZ,CAAgB,qBAAhB;KARhB,CATgB;;QAqBZiG,aAAajL,IAAI4G,KAAJ,GAAY9F,mBAAmB4N,SAASjK,IAA5B,CAAZ,GAAgD3D,mBAAmB4N,SAASC,KAA5B,CAAhD,GACf7N,mBAAmB4N,SAASE,UAA5B,CADe,GAC2B9N,mBAAmB4N,SAASG,WAA5B,CAD5C;QAEE3D,cAAclL,IAAI6G,MAAJ,GAAa/F,mBAAmB4N,SAAShK,GAA5B,CAAb,GAAgD5D,mBAAmB4N,SAASI,MAA5B,CAAhD,GACZhO,mBAAmB4N,SAASK,SAA5B,CADY,GAC6BjO,mBAAmB4N,SAASM,YAA5B,CAH7C;QAKIC,eAAe,CAAC,KAAKnK,OAAL,CAAamK,YAAb,GAA4B,CAA5B,GAAgC,KAAKnK,OAAL,CAAamK,YAA7C,GAA4D,CAA7D,IAAkE,CAArF;;YAEUlG,KAAKmG,GAAL,CAASd,YAAYnD,aAAagE,YAAzB,CAAT,EAAiDZ,aAAanD,cAAc+D,YAA3B,CAAjD,EAA2F,CAA3F,CAFV;QAII3H,WAAWyB,KAAKC,GAAL,CAASiC,aAAakE,KAAtB,EAA6B,KAAKrK,OAAL,CAAamG,UAA1C,CAAf;QACE1D,YAAYwB,KAAKC,GAAL,CAASkC,cAAciE,KAAvB,EAA8B,KAAKrK,OAAL,CAAaoG,WAA3C,CADd;eAGW,KAAKpG,OAAL,CAAasK,cAAb,GAA8B,KAAKtK,OAAL,CAAamG,UAA3C,GAAwDlC,KAAKsG,KAAL,CAAW/H,QAAX,CAAnE;gBACY,KAAKxC,OAAL,CAAasK,cAAb,GAA8B,KAAKtK,OAAL,CAAaoG,WAA3C,GAAyDnC,KAAKsG,KAAL,CAAW9H,SAAX,CAArE;QAEI+H,cAAc;aACThI,WAAW,IADF;cAERC,YAAY,IAFJ;YAGV,CAAC6G,WAAW9G,QAAZ,IAAwB,CAAxB,GAA4BgH,UAA5B,GAAyC,IAH/B;WAIX,CAACD,YAAY9G,SAAb,IAA0B,CAA1B,GAA8BgH,SAA9B,GAA0C;KAJjD,CApCgB;;QA4CZ,KAAKzJ,OAAL,CAAayK,aAAjB,EAAgC;WAEzB3E,YAAL,CAAkB4E,OAAlB,CAA0BF,WAA1B,EAAuC,YAAY;aAC5CG,YAAL,CAAkBzP,GAAlB;OADF;KAFF,MAMO;WAEA4K,YAAL,CAAkB5F,GAAlB,CAAsBsK,WAAtB;WACKG,YAAL,CAAkBzP,GAAlB;;;SAIGmK,QAAL,GAAgB,IAAhB;;;SAIFsF,qCAAazP,KAAK;QAEZwC,YAAY;SACX,KAAKsI,MAAL,CAAYlE,KAAZ,EADW;SAEX,KAAKkE,MAAL,CAAYjE,MAAZ;KAFL,CAFgB;;QAQZsI,QAAQ,CAAZ;;QAEI,CAAC,KAAKzM,SAAV,EAAqB;cACXqG,KAAKmG,GAAL,CAAS1M,UAAUI,CAAV,GAAc5C,IAAI4G,KAA3B,EAAkCpE,UAAUK,CAAV,GAAc7C,IAAI6G,MAApD,EAA4D,CAA5D,CAAR;KADF,MAEO;cACGkC,KAAKmG,GAAL,CAAS1M,UAAUI,CAAV,GAAc5C,IAAI6G,MAA3B,EAAmCrE,UAAUK,CAAV,GAAc7C,IAAI4G,KAArD,EAA4D,CAA5D,CAAR;;;SAGGmE,MAAL,CAAY/F,GAAZ,CAAgB;aACP+D,KAAK2G,IAAL,CAAU1P,IAAI4G,KAAJ,GAAYuI,KAAtB,IAA+B,IADxB;cAENpG,KAAK2G,IAAL,CAAU1P,IAAI6G,MAAJ,GAAasI,KAAvB,IAAgC,IAF1B;YAGR,CAAC3M,UAAUI,CAAV,GAAcmG,KAAK2G,IAAL,CAAU1P,IAAI4G,KAAJ,GAAYuI,KAAtB,CAAf,IAA+C,CAA/C,GAAmD,IAH3C;WAIT,CAAC3M,UAAUK,CAAV,GAAckG,KAAK2G,IAAL,CAAU1P,IAAI6G,MAAJ,GAAasI,KAAvB,CAAf,IAAgD,CAAhD,GAAoD;KAJ3D,EAhBgB;;QAwBd/H,MAAF,CAAS,KAAK7E,SAAd,EAAyB;aAChBvC,IAAI4G,KAAJ,GAAYuI,KADI;cAEfnP,IAAI6G,MAAJ,GAAasI,KAFE;YAGjB,CAAC3M,UAAUI,CAAV,GAAc5C,IAAI4G,KAAJ,GAAYuI,KAA3B,IAAoC,CAHnB;WAIlB,CAAC3M,UAAUK,CAAV,GAAc7C,IAAI6G,MAAJ,GAAasI,KAA5B,IAAqC;KAJ5C,EAxBgB;;kBAgCF;SAAK,KAAKpE,MAAL,CAAYnE,KAAZ,EAAL;SAA6B,KAAKmE,MAAL,CAAYlE,MAAZ;KAA3C,EAAmE;SAAK,KAAKiE,MAAL,CAAYlE,KAAZ,EAAL;SAA6B,KAAKkE,MAAL,CAAYjE,MAAZ;KAAhG,EACE,KAAKiE,MADP,EAEE,KAAKpI,SAFP,EAhCgB;;SAsCXkI,YAAL,CAAkBiC,IAAlB,CAAuBhJ,WAAW,SAAlC,EAA6CiK,MAA7C,GAtCgB;;QAyCZ,KAAKhJ,OAAL,CAAayK,aAAjB,EAAgC;WACzBxE,MAAL,CAAY4E,MAAZ;;;;SAKJjF,2BAAQF,QAAQ;QAEVnG,OAAO,IAAX;QAEIuL,+BAA4BhM,EAA5B,qBAAJ,CAJc;;SAOTgH,YAAL,CAAkB3C,MAAlB,CAAyB2H,UAAzB;;QAEI,KAAK9K,OAAL,CAAayK,aAAjB,EAAgC;WACzBxE,MAAL,CAAY8E,IAAZ;;;SAGG9E,MAAL,CAAY5L,IAAZ,CAAiB,KAAjB,EAAwBqL,MAAxB;eAEWA,MAAX,EAAmB,UAAUxK,GAAV,EAAe;;WAG3BuC,SAAL,GAAiB;uBACAvC,IAAI4G,KADJ;wBAEC5G,IAAI6G;OAFtB;;UAKIxC,KAAK4B,WAAL,IAAqB5B,KAAK8F,QAAL,IAAiB9F,KAAKS,OAAL,CAAagL,aAAvD,EAAuE;aAChEL,YAAL,CAAkBzP,GAAlB;OADF,MAEO;aACAyO,YAAL,CAAkBzO,GAAlB;;;WAGG8K,MAAL,CAAY9H,WAAZ,CAAwB,aAAxB;WACK+H,MAAL,CAAY/H,WAAZ,CAAwB,aAAxB;KAfF,EAiBG,YAAY;;WAER4H,YAAL,CAAkBiC,IAAlB,CAAuBhJ,WAAW,SAAlC,EAA6CiK,MAA7C;KAnBF;;QAsBI,KAAKhJ,OAAL,CAAa4G,KAAjB,EAAwB;WACjBqE,WAAL,CAAiBvF,MAAjB;;;;SAKJuF,mCAAYrP,KAAK;QAEXsP,UAAU,KAAK1F,SAAL,CAAe,KAAKC,UAApB,EAAgCyF,OAA9C;QACEC,aAAaD,UAAUA,OAAV,GAAoBvP,oBAAoBC,GAApB,CADnC;SAGKuM,MAAL,CAAYiD,IAAZ,CAAiBD,UAAjB;;;SAIFE,qBAAK5E,OAAO;SAELhB,UAAL,GAAkB,KAAKA,UAAL,GAAkBgB,KAApC;SAEK6E,MAAL,CAAY,KAAK7F,UAAjB;;;SAIF6F,yBAAO7E,OAAO;YAEJA,QAAQ,KAAKjB,SAAL,CAAelF,MAA/B;;QAEImG,SAAS,CAAb,EAAgB;cACNA,QAAQ,KAAKjB,SAAL,CAAelF,MAA/B;KADF,MAEO,IAAImG,QAAQ,CAAZ,EAAe;cACZ,CAAC,KAAKjB,SAAL,CAAelF,MAAf,GAAwBmG,KAAzB,IAAkC,KAAKjB,SAAL,CAAelF,MAAzD;;;SAGGmF,UAAL,GAAkBgB,KAAlB;;SAEKyC,YAAL,CAAkB,cAAlB,EAAkCzC,KAAlC;;SAEKb,OAAL,CAAa,KAAKJ,SAAL,CAAeiB,KAAf,EAAsBrM,GAAnC;;SAEK8O,YAAL,CAAkB,SAAlB,EAA6BzC,KAA7B;;;SAIF8E,uBAAMzL,GAAG;MAELoB,cAAF;QAEIsK,QAAQ,CAAZ;;QAEI1L,EAAEU,aAAF,CAAgBiL,MAApB,EAA4B;cAClB3L,EAAEU,aAAF,CAAgBiL,MAAhB,GAAyB,CAAzB,GAA6B,CAA7B,GAAiC,CAAC,CAA1C;KADF,MAEO,IAAI3L,EAAEU,aAAF,CAAgBkL,UAApB,EAAgC;cAC7B,CAAC5L,EAAEU,aAAF,CAAgBkL,UAAjB,GAA8B,GAAtC;KADK,MAEA,IAAI5L,EAAEU,aAAF,CAAgBmL,MAApB,EAA4B;cACzB7L,EAAEU,aAAF,CAAgBmL,MAAhB,GAAyB,CAAzB,GAA6B,CAA7B,GAAiC,CAAC,CAA1C;KAXK;;;QAeHC,QAAQ,CAACJ,KAAD,GAAS,KAAKxL,OAAL,CAAa6L,cAAlC,CAfO;;QAkBHC,UAAU;SACThM,EAAEU,aAAF,CAAgBG,OAAhB,GAA0B,KAAKqF,MAAL,CAAYlF,MAAZ,GAAqBnB,IAA/C,GAAsDrB,GAAGkL,UAAH,EAD7C;SAET1J,EAAEU,aAAF,CAAgBK,OAAhB,GAA0B,KAAKmF,MAAL,CAAYlF,MAAZ,GAAqBlB,GAA/C,GAAqDtB,GAAGmL,SAAH;KAF1D;SAKKsC,IAAL,CAAUH,KAAV,EAAiBE,OAAjB,EAA0BhM,CAA1B;;;SAIFiM,qBAAKH,OAAOI,QAAQlM,GAAG;;YAGb8L,QAAQ,CAAR,GAAa,KAAK,IAAIA,KAAT,CAAb,GAAiC,IAAIA,KAA7C;;QAEIA,QAAQ,IAAR,IAAgBA,QAAQ,IAA5B,EAAkC;cACxB,CAAR;;;YAGM,KAAK3F,MAAL,CAAYnE,KAAZ,KAAsB,KAAKrE,SAAL,CAAewO,aAArC,GAAqDL,KAA7D,CATqB;;YAYb3H,KAAKC,GAAL,CAAS0H,KAAT,EAAgB,KAAK5L,OAAL,CAAakM,QAA7B,CAAR,CAZqB;;YAcbjI,KAAKmG,GAAL,CAASwB,KAAT,EAAgB,KAAK5L,OAAL,CAAamM,QAA7B,CAAR;SAEKC,MAAL,CAAYR,KAAZ,EAAmBI,MAAnB,EAA2BlM,CAA3B;;;SAIFsM,yBAAOR,OAAOI,QAAQlM,GAAG;QAEnBmG,SAAS,KAAKA,MAAlB;QACED,SAAS,KAAKA,MADhB;QAEEqG,UAAU;SACL,KAAK5O,SAAL,CAAeqE,KADV;SAEL,KAAKrE,SAAL,CAAesE,MAFV;SAGL,KAAKtE,SAAL,CAAekC,IAHV;SAIL,KAAKlC,SAAL,CAAemC;KANtB,CAFuB;;;QAanBlC,YAAY;SACXsI,OAAOlE,KAAP,EADW;SAEXkE,OAAOjE,MAAP,EAFW;SAGXiE,OAAOlF,MAAP,GAAgBnB,IAHL;SAIXqG,OAAOlF,MAAP,GAAgBlB;KAJrB;QAOI0M,WAAW,KAAK7O,SAAL,CAAewO,aAAf,GAA+BL,KAA9C;QACEW,YAAY,KAAK9O,SAAL,CAAe+O,cAAf,GAAgCZ,KAD9C;;cAGYI,OAAOS,CAAP,GAAW,CAACT,OAAOS,CAAP,GAAWJ,QAAQI,CAApB,IAAyBJ,QAAQvO,CAAjC,GAAqCwO,QAH5D;QAIEjK,SAAS2J,OAAOU,CAAP,GAAW,CAACV,OAAOU,CAAP,GAAWL,QAAQK,CAApB,IAAyBL,QAAQtO,CAAjC,GAAqCwO,SAJ3D,CApBuB;;QA2BnB1K,IAAI,CAAC,KAAKjE,SAAN,GAAkB,CAAlB,GAAsB,CAAC0O,WAAWC,SAAZ,IAAyB,CAAvD;QACEI,cAAc,CAAC,KAAK/O,SAAN,GAAkB0O,QAAlB,GAA6BC,SAD7C;QAEEK,eAAe,CAAC,KAAKhP,SAAN,GAAkB2O,SAAlB,GAA8BD,QAF/C;QAII5I,UAAUhG,UAAUI,CAAV,GAAcwO,QAA5B;QACE3I,UAAUjG,UAAUK,CAAV,GAAcwO,SAD1B,CA/BuB;;;;QAqCnBK,gBAAgBlP,UAAUK,CAA9B,EAAiC;eACtB,CAACL,UAAUK,CAAV,GAAcwO,SAAf,IAA4B,CAArC;KADF,MAEO;eACIlK,SAASR,CAAT,GAAaA,CAAb,GAAkBQ,SAAUsB,UAAU9B,CAApB,GAAyBQ,MAAzB,GAAmCsB,UAAU9B,CAAxE;;;QAGE8K,eAAejP,UAAUI,CAA7B,EAAgC;gBACpB,CAACJ,UAAUI,CAAV,GAAcwO,QAAf,IAA2B,CAArC;KADF,MAEO;gBACKlK,UAAU,CAACP,CAAX,GAAe,CAACA,CAAhB,GAAqBO,UAAWsB,UAAU7B,CAArB,GAA0BO,OAA1B,GAAqCsB,UAAU7B,CAA9E;;;WAGK3B,GAAP,CAAW;aACF+D,KAAKsG,KAAL,CAAW+B,QAAX,IAAuB,IADrB;cAEDrI,KAAKsG,KAAL,CAAWgC,SAAX,IAAwB,IAFvB;YAGHtI,KAAKsG,KAAL,CAAWnI,OAAX,IAAsB,IAHnB;WAIJ6B,KAAKsG,KAAL,CAAWlI,MAAX,IAAqB;KAJ5B,EAjDuB;;QAyDrBC,MAAF,CAAS,KAAK7E,SAAd,EAAyB;aAChB6O,QADgB;cAEfC,SAFe;YAGjBnK,OAHiB;WAIlBC;KAJP,EAzDuB;;kBAiET;SAAK4B,KAAKsG,KAAL,CAAWoC,WAAX,CAAL;SAAiC1I,KAAKsG,KAAL,CAAWqC,YAAX;KAA/C,EAA2E;SAAKlP,UAAUI,CAAf;SAAqBJ,UAAUK;KAA1G,EACE,KAAKiI,MADP;;;SAMF6G,yBAAOC,OAAO;SAEPxH,WAAL,GAAmB,KAAKA,WAAL,GAAmBwH,KAAtC;;QAEK,KAAKxH,WAAL,GAAmB,EAApB,GAA0B,CAA1B,KAAgC,CAApC,EAAuC;WAChC1H,SAAL,GAAiB,KAAjB;KADF,MAEO;WACAA,SAAL,GAAiB,IAAjB;;;SAGGmP,QAAL,CAAc,KAAKzH,WAAnB;;;SAIFyH,6BAASD,OAAO;AAEd,AAEA,SAAK7G,MAAL,CAAY/F,GAAZ,CAAgB;iBACH,YAAY4M,KAAZ,GAAoB;KADjC;SAIKnC,YAAL,CAAkB;aAAS,KAAKlN,SAAL,CAAewO,aAAxB;cAA+C,KAAKxO,SAAL,CAAe+O;KAAhF,EARc;;SAWTxG,MAAL,CAAY9H,WAAZ,CAAwB,SAAxB;;;SAIF8O,2BAAS;QAEHzN,OAAO,IAAX;QAEI0N,gBAAgB3S,SAAS,YAAY;UAEnCiF,KAAK8F,QAAT,EAAmB;YAEb9F,KAAK4B,WAAT,EAAsB;eACfwJ,YAAL,CAAkB;mBAASpL,KAAK9B,SAAL,CAAewO,aAAxB;oBAA+C1M,KAAK9B,SAAL,CAAe+O;WAAhF;SADF,MAEO;eACA7C,YAAL,CAAkB;mBAASpK,KAAK9B,SAAL,CAAewO,aAAxB;oBAA+C1M,KAAK9B,SAAL,CAAe+O;WAAhF;;;KAPc,EAYjB,GAZiB,CAApB;WAcOS,aAAP;;;SAIF/F,+BAAW;AAET;QAEI,CAAC,KAAK/F,WAAV,EAAuB;;WAEhBiC,SAAL,GAAiB;eACR,KAAK0C,YAAL,CAAkBhE,KAAlB,EADQ;gBAEP,KAAKgE,YAAL,CAAkB/D,MAAlB,EAFO;cAGT,KAAK+D,YAAL,CAAkBhF,MAAlB,GAA2BnB,IAHlB;aAIV,KAAKmG,YAAL,CAAkBhF,MAAlB,GAA2BlB;OAJlC;WAOKkG,YAAL,CAAkB7H,QAAlB,CAA2Ba,KAAK,WAAhC;WAEKgH,YAAL,CAAkB5F,GAAlB,CAAsB;eACb,MADa;gBAEZ,MAFY;cAGd,CAHc;aAIf;OAJP;WAOKiB,WAAL,GAAmB,IAAnB;KAlBF,MAoBO;WAEA2E,YAAL,CAAkB5H,WAAlB,CAA8BY,KAAK,WAAnC;WAEKgH,YAAL,CAAkB5F,GAAlB,CAAsB;eACb,KAAKkD,SAAL,CAAetB,KAAf,GAAuB,KAAKsB,SAAL,CAAetB,KAAtC,GAA8C,KAAK9B,OAAL,CAAamG,UAD9C;gBAEZ,KAAK/C,SAAL,CAAerB,MAAf,GAAwB,KAAKqB,SAAL,CAAerB,MAAvC,GAAgD,KAAK/B,OAAL,CAAaoG,WAFjD;cAGd,KAAKhD,SAAL,CAAezD,IAAf,GAAsB,KAAKyD,SAAL,CAAezD,IAArC,GAA4C,CAACtB,GAAGyD,KAAH,KAAa,KAAK9B,OAAL,CAAamG,UAA3B,IAAyC,CAAzC,GAA6C7H,GAAGkL,UAAH,EAH3E;aAIf,KAAKpG,SAAL,CAAexD,GAAf,GAAqB,KAAKwD,SAAL,CAAexD,GAApC,GAA0C,CAACvB,GAAG0D,MAAH,KAAc,KAAK/B,OAAL,CAAaoG,WAA5B,IAA2C,CAA3C,GAA+C9H,GAAGmL,SAAH;OAJhG;WAOKtI,WAAL,GAAmB,KAAnB;;;SAGGwJ,YAAL,CAAkB;aAAS,KAAKlN,SAAL,CAAewO,aAAxB;cAA+C,KAAKxO,SAAL,CAAe+O;KAAhF;;;SAIFhF,mCAAa;sBAEO,KAAK1B,YAAL,CAAkB,CAAlB,CAAlB;;;SAIFoH,2BAAQpN,GAAG;QAELP,OAAO,IAAX;;QAEI,CAAC,KAAKS,OAAL,CAAamN,QAAlB,EAA4B;aACnB,KAAP;;;QAGEC,UAAUtN,EAAEsN,OAAF,IAAatN,EAAEuN,KAAf,IAAwBvN,EAAEwN,QAAxC;QACEC,UAAUzN,EAAEyN,OAAF,IAAazN,EAAE0N,OAD3B;QAEEC,SAAS3N,EAAE2N,MAAF,IAAY3N,EAAE0N,OAFzB;;YAIQJ,OAAR;;WAEO,EAAL;aACO/B,IAAL,CAAU,CAAC,CAAX;;;;WAGG,EAAL;aACOA,IAAL,CAAU,CAAV;;;;WAGG,GAAL;aACOU,IAAL,CAAUxM,KAAKS,OAAL,CAAa6L,cAAb,GAA8B,CAAxC,EAA2C;aAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;aAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;SAAnG,EAAwGjC,CAAxG;;;;WAGG,GAAL;aACOiM,IAAL,CAAU,CAACxM,KAAKS,OAAL,CAAa6L,cAAd,GAA+B,CAAzC,EAA4C;aAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;aAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;SAApG,EAAyGjC,CAAzG;;;;WAGG,EAAL;aACOiM,IAAL,CAAUxM,KAAKS,OAAL,CAAa6L,cAAb,GAA8B,CAAxC,EAA2C;aAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;aAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;SAAnG,EAAwGjC,CAAxG;;;;WAGG,GAAL;aACOiM,IAAL,CAAU,CAACxM,KAAKS,OAAL,CAAa6L,cAAd,GAA+B,CAAzC,EAA4C;aAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;aAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;SAApG,EAAyGjC,CAAzG;;;;WAGG,EAAL;YACMyN,WAAWE,MAAf,EAAuB;eAChBrB,MAAL,CAAY,CAAZ,EAAe;eAAK7M,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;eAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;WAAvE,EAA4EjC,CAA5E;;;;;;WAIC,GAAL;YACMyN,OAAJ,EAAa;eACNV,MAAL,CAAY,CAAC,EAAb;;;;;;WAIC,GAAL;YACMU,OAAJ,EAAa;eACNV,MAAL,CAAY,EAAZ;;;;;;;;;SAQR1D,iCAAY;QAEN5J,OAAO,IAAX;SAEK6I,MAAL,CAAY5G,GAAZ,CAAgBjD,cAAcS,QAA9B,EAAwC+B,EAAxC,CAA2CxC,cAAcS,QAAzD,EAAmE,UAAUc,CAAV,EAAa;WACzEqH,KAAL;KADF;SAIKnB,MAAL,CAAYxE,GAAZ,CAAgB9C,cAAcM,QAA9B,EAAwC+B,EAAxC,CAA2CrC,cAAcM,QAAzD,EAAmE,UAAUc,CAAV,EAAa;WACzEyL,KAAL,CAAWzL,CAAX;KADF;SAIKyI,OAAL,CAAa/G,GAAb,CAAiBjD,cAAcS,QAA/B,EAAyC+B,EAAzC,CAA4CxC,cAAcS,QAA1D,EAAoE,UAAUc,CAAV,EAAa;WAC1EiM,IAAL,CAAUxM,KAAKS,OAAL,CAAa6L,cAAb,GAA8B,CAAxC,EAA2C;WAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;WAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;OAAnG,EAAwGjC,CAAxG;KADF;SAIK0I,QAAL,CAAchH,GAAd,CAAkBjD,cAAcS,QAAhC,EAA0C+B,EAA1C,CAA6CxC,cAAcS,QAA3D,EAAqE,UAAUc,CAAV,EAAa;WAC3EiM,IAAL,CAAU,CAACxM,KAAKS,OAAL,CAAa6L,cAAd,GAA+B,CAAzC,EAA4C;WAAKtM,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;WAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;OAApG,EAAyGjC,CAAzG;KADF;SAIK2I,WAAL,CAAiBjH,GAAjB,CAAqBjD,cAAcS,QAAnC,EAA6C+B,EAA7C,CAAgDxC,cAAcS,QAA9D,EAAwE,UAAUc,CAAV,EAAa;WAC9EsM,MAAL,CAAY,CAAZ,EAAe;WAAK7M,KAAKyG,MAAL,CAAYlE,KAAZ,KAAsB,CAA3B;WAAiCvC,KAAKyG,MAAL,CAAYjE,MAAZ,KAAuB;OAAvE,EAA4EjC,CAA5E;KADF;SAIK+I,KAAL,CAAWrH,GAAX,CAAejD,cAAcS,QAA7B,EAAuC+B,EAAvC,CAA0CxC,cAAcS,QAAxD,EAAkE,YAAY;WACvEqM,IAAL,CAAU,CAAC,CAAX;KADF;SAIK3C,WAAL,CAAiBlH,GAAjB,CAAqBjD,cAAcS,QAAnC,EAA6C+B,EAA7C,CAAgDxC,cAAcS,QAA9D,EAAwE,YAAY;WAC7EwI,UAAL;KADF;SAIKsB,KAAL,CAAWtH,GAAX,CAAejD,cAAcS,QAA7B,EAAuC+B,EAAvC,CAA0CxC,cAAcS,QAAxD,EAAkE,YAAY;WACvEqM,IAAL,CAAU,CAAV;KADF;SAIK1C,WAAL,CAAiBnH,GAAjB,CAAqBjD,cAAcS,QAAnC,EAA6C+B,EAA7C,CAAgDxC,cAAcS,QAA9D,EAAwE,YAAY;WAC7E6N,MAAL,CAAY,CAAC,EAAb;KADF;SAIKjE,YAAL,CAAkBpH,GAAlB,CAAsBjD,cAAcS,QAApC,EAA8C+B,EAA9C,CAAiDxC,cAAcS,QAA/D,EAAyE,YAAY;WAC9E6N,MAAL,CAAY,EAAZ;KADF;SAIKxE,SAAL,CAAe7G,GAAf,CAAmBjD,cAAcS,QAAjC,EAA2C+B,EAA3C,CAA8CxC,cAAcS,QAA5D,EAAsE,YAAY;WAC3EkI,QAAL;KADF;OAIG1F,GAAH,CAAO/C,gBAAgBO,QAAvB,EAAiC+B,EAAjC,CAAoCtC,gBAAgBO,QAApD,EAA8D,UAAUc,CAAV,EAAa;WACpEoN,OAAL,CAAapN,CAAb;KADF;OAIGiB,EAAH,CAAMvC,eAAeQ,QAArB,EAA+BO,KAAKyN,MAAL,EAA/B;;;SAIF9D,qCAAapJ,GAAG4N,MAAM;QAChB,KAAK1N,OAAL,CAAa2N,SAAb,CAAuB7N,CAAvB,CAAJ,EAA+B;WACxBE,OAAL,CAAa2N,SAAb,CAAuB7N,CAAvB,EAA0BhF,KAA1B,CAAgC,IAAhC,EAAsCd,IAAEiL,OAAF,CAAUyI,IAAV,IAAkBA,IAAlB,GAAyB,CAACA,IAAD,CAA/D;;;;;;;;;;;AAUN1T,IAAEsI,MAAF,CAASwC,YAAY8I,SAArB,EAAgC/H,SAAhC,EAA2CE,OAA3C,EAAoDG,SAApD;;;;;AAKAxJ,OAAOoI,WAAP,GAAqBA,WAArB;;;;;AAMA,IAAI+I,OAAO,IAAX;IACEC,cAAc,SAAdA,WAAc,CAAUC,IAAV,EAAgBC,SAAhB,EAA2B;MAEnCjJ,QAAQ,EAAZ;MAEEgJ,IAAF,EAAQnJ,IAAR,CAAa,YAAY;QAEnBxK,MAAMF,UAAU,IAAV,CAAV;UAEM+T,IAAN,CAAW;WACJ7T,GADI;eAEAJ,IAAE,IAAF,EAAQK,IAAR,CAAa,cAAb,CAFA;iBAGE2T;KAHb;GAJF;SAYOjJ,KAAP;CAjBJ;;AAqBA/K,IAAEO,EAAF,CAAK2T,WAAL,GAAmB,UAAUlO,OAAV,EAAmB;SAE7BhG,IAAE,IAAF,CAAP;YAEUgG,UAAUA,OAAV,GAAoB,EAA9B,CAJoC;;OAO/B,IAAImO,GAAT,IAAgBnO,OAAhB,EAAyB;QACnB,OAAQA,QAAQmO,GAAR,CAAR,KAA0B,QAA1B,IAAsC,CAACC,MAAMpO,QAAQmO,GAAR,CAAN,CAA3C,EAAgE;cACtDA,GAAR,IAAe9R,WAAW2D,QAAQmO,GAAR,CAAX,CAAf;;GATgC;;;MAchCnK,OAAOhK,IAAEsI,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB0C,QAAnB,EAA6BhF,OAA7B,CAAX,CAdoC;;cAiBxB,QAAZ,IAAwBgE,KAAK7E,MAA7B;;MAEI,OAAOa,OAAP,KAAmB,QAAvB,EAAiC,CAAjC,MAIO;SAEAwB,GAAL,CAASjD,cAAcS,QAAvB,EAAiC+B,EAAjC,CAAoCxC,cAAcS,QAAlD,EAA4D,UAAUc,CAAV,EAAa;QAErEoB,cAAF,GAFuE;;QAIrEmN,eAAF,GAJuE;;UAOnEtJ,QAAQ,EAAZ;UACEuJ,mBAAmBtU,IAAE,IAAF,EAAQK,IAAR,CAAa,YAAb,CADrB;UAEEkU,YAAYjQ,GAAGyJ,IAAH,CAAQ,kBAAkBuG,gBAAlB,GAAqC,IAA7C,CAFd;;UAIIA,qBAAqBE,SAAzB,EAAoC;gBAC1BV,YAAYS,SAAZ,EAAuBD,gBAAvB,CAAR;gBACQ,OAAR,IAAmBtU,IAAE,IAAF,EAAQyM,KAAR,CAAc,kBAAkB6H,gBAAlB,GAAqC,IAAnD,CAAnB;OAFF,MAGO;gBACGR,YAAYD,KAAKY,GAAL,CAAS,cAAT,CAAZ,CAAR;gBACQ,OAAR,IAAmBzU,IAAE,IAAF,EAAQyM,KAAR,EAAnB;;;UAGA,IAAF,EAAQiH,IAAR,CAAa5O,EAAb,EAAiB,IAAIgG,WAAJ,CAAgBC,KAAhB,EAAuB/E,OAAvB,EAAgC,IAAhC,CAAjB;KAnBF;;;SAyBK6N,IAAP;CAlDF;;;;;;AAyDAvP,GAAGyC,EAAH,CAAMxC,cAAcS,QAApB,EAA8B,WAAWF,EAAX,GAAgB,GAA9C,EAAmD,UAAUgB,CAAV,EAAa;SAEvD9F,IAAE,WAAW8E,EAAX,GAAgB,GAAlB,CAAP;IAEEoC,cAAF,GAJ8D;;MAO1D6D,QAAQ,EAAZ;MACEuJ,mBAAmBtU,IAAE,IAAF,EAAQK,IAAR,CAAa,YAAb,CADrB;MAEEkU,YAAYjQ,GAAGyJ,IAAH,CAAQ,kBAAkBuG,gBAAlB,GAAqC,IAA7C,CAFd;;MAIIA,qBAAqBE,SAAzB,EAAoC;YAC1BV,YAAYS,SAAZ,EAAuBD,gBAAvB,CAAR;aACS,OAAT,IAAoBtU,IAAE,IAAF,EAAQyM,KAAR,CAAc,kBAAkB6H,gBAAlB,GAAqC,IAAnD,CAApB;GAFF,MAGO;YACGR,YAAYD,KAAKY,GAAL,CAAS,cAAT,CAAZ,CAAR;aACS,OAAT,IAAoBzU,IAAE,IAAF,EAAQyM,KAAR,EAApB;;;MAGA,IAAF,EAAQiH,IAAR,CAAa5O,EAAb,EAAiB,IAAIgG,WAAJ,CAAgBC,KAAhB,EAAuBC,QAAvB,EAAiC,IAAjC,CAAjB;CAnBF;;;;"}